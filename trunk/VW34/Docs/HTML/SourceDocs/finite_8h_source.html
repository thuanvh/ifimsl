<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>VW: finite.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen_vw.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
  <div class="navpath"><a class="el" href="dir_5566a08a770a608272109a5d04799f37.html">VNL</a>
  </div>
<div class="contents">
<h1>finite.h</h1><a href="finite_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// This is vxl/VNL/finite.h</span>
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef vnl_finite_h_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#define vnl_finite_h_</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;cmath&gt;</span> <span class="comment">// for sqrt</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00039"></a>00039 
<a name="l00049"></a>00049 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00050"></a><a class="code" href="classvnl__finite__int.html">00050</a> <span class="keyword">class </span><a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int</a> {
<a name="l00051"></a>00051   <span class="keyword">typedef</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>;
<a name="l00052"></a>00052  <span class="keyword">public</span>:
<a name="l00055"></a><a class="code" href="classvnl__finite__int.html#ace3d66b95dd3aa65bfffb05b78317ed8">00055</a>   <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int.html#ace3d66b95dd3aa65bfffb05b78317ed8" title="The number of different finite_int numbers of this type.">cardinality</a>() { <span class="keywordflow">return</span> N; }
<a name="l00056"></a>00056 
<a name="l00061"></a><a class="code" href="classvnl__finite__int.html#afaf6bb3de92aacec10f0cc9592598a30">00061</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#afaf6bb3de92aacec10f0cc9592598a30" title="Creates a finite int element.">vnl_finite_int</a>(<span class="keywordtype">int</span> x = 0) : val_((x%=N)&lt;0?N+x:x), mo_(0), lp1_(0) {assert(N&gt;1);}
<a name="l00062"></a>00062   <span class="comment">//  Copy constructor</span>
<a name="l00063"></a><a class="code" href="classvnl__finite__int.html#abdf2056f39ab5155686799e461d5cac8">00063</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#abdf2056f39ab5155686799e461d5cac8">vnl_finite_int</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; x) : val_(int(x)), mo_(x.mo_), lp1_(x.lp1_) {}
<a name="l00064"></a>00064   <span class="comment">//  Destructor</span>
<a name="l00065"></a><a class="code" href="classvnl__finite__int.html#a9357d4fb3c2f5e781fd66b38dc5c7ea0">00065</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#a9357d4fb3c2f5e781fd66b38dc5c7ea0">~vnl_finite_int</a>() {}
<a name="l00066"></a>00066   <span class="comment">// Implicit conversions</span>
<a name="l00067"></a><a class="code" href="classvnl__finite__int.html#ae513aa0bf1c65b74cfd8074fb49a4a7e">00067</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#ae513aa0bf1c65b74cfd8074fb49a4a7e">operator int</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> val_; }
<a name="l00068"></a><a class="code" href="classvnl__finite__int.html#ae390fd3ef47fd6bd91165129c9055b2a">00068</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#ae390fd3ef47fd6bd91165129c9055b2a">operator int</a>() { <span class="keywordflow">return</span> val_; }
<a name="l00069"></a><a class="code" href="classvnl__finite__int.html#a8dccdb93a4eb2aed3ba4bf21b95857af">00069</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#a8dccdb93a4eb2aed3ba4bf21b95857af">operator long</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> val_; }
<a name="l00070"></a><a class="code" href="classvnl__finite__int.html#a7ce589f076a7995d612808e7dfcac921">00070</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#a7ce589f076a7995d612808e7dfcac921">operator long</a>() { <span class="keywordflow">return</span> val_; }
<a name="l00071"></a><a class="code" href="classvnl__finite__int.html#ab3c3e24c8232f29b5e35c438d883d1b6">00071</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#ab3c3e24c8232f29b5e35c438d883d1b6">operator short</a>()<span class="keyword"> const </span>{ <span class="keywordtype">short</span> r = (short)val_; assert(r == val_); <span class="keywordflow">return</span> r; }
<a name="l00072"></a><a class="code" href="classvnl__finite__int.html#a5c72d27b6ba7abf3191d1ed80c1afda8">00072</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html#a5c72d27b6ba7abf3191d1ed80c1afda8">operator short</a>() { <span class="keywordtype">short</span> r = (short)val_; assert(r == val_); <span class="keywordflow">return</span> r; }
<a name="l00073"></a>00073 
<a name="l00076"></a><a class="code" href="classvnl__finite__int.html#a5f0eae536c82bc4c67ec72cfd58da9da">00076</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a5f0eae536c82bc4c67ec72cfd58da9da" title="Assignment.">operator=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; x) { val_ = int(x); mo_=x.mo_; lp1_=x.lp1_; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00077"></a><a class="code" href="classvnl__finite__int.html#a341917ee4dce99ec8763b5671c8eb958">00077</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a341917ee4dce99ec8763b5671c8eb958">operator=</a>(<span class="keywordtype">int</span> x) { x%=N; val_ = x&lt;0 ? N+x : x; mo_=lp1_=0; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00078"></a>00078 
<a name="l00082"></a><a class="code" href="classvnl__finite__int.html#a230286cbc2d28584b41b95ed0b1b36d7">00082</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#a230286cbc2d28584b41b95ed0b1b36d7" title="Comparison of finite int numbers.">operator==</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> val_ == int(x); }
<a name="l00083"></a><a class="code" href="classvnl__finite__int.html#a93dbfe3c0ed32818d32c3b208b78fde2">00083</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#a93dbfe3c0ed32818d32c3b208b78fde2">operator!=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> val_ != int(x); }
<a name="l00084"></a><a class="code" href="classvnl__finite__int.html#a77b38de528fba48b93e8aa57284cf904">00084</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#a77b38de528fba48b93e8aa57284cf904">operator==</a>(<span class="keywordtype">int</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html#a77b38de528fba48b93e8aa57284cf904">operator==</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>(x)); }
<a name="l00085"></a><a class="code" href="classvnl__finite__int.html#a0e786441162d0e30a31daaa126316c0a">00085</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#a0e786441162d0e30a31daaa126316c0a">operator!=</a>(<span class="keywordtype">int</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="classvnl__finite__int.html#a230286cbc2d28584b41b95ed0b1b36d7" title="Comparison of finite int numbers.">operator==</a>(x); }
<a name="l00086"></a>00086 
<a name="l00089"></a><a class="code" href="classvnl__finite__int.html#a401b1c717c08fc1b2eba784252520a11">00089</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#a401b1c717c08fc1b2eba784252520a11" title="Unary minus - returns the additive inverse.">operator-</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>(N-val_); }
<a name="l00092"></a><a class="code" href="classvnl__finite__int.html#ab610827cc5004bfa051340ebff48c7b3">00092</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#ab610827cc5004bfa051340ebff48c7b3" title="Unary plus - returns the current number.">operator+</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00095"></a><a class="code" href="classvnl__finite__int.html#af80ad95a1bb858737ae0f40611bc7c0c">00095</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#af80ad95a1bb858737ae0f40611bc7c0c" title="Unary not - returns true if finite int number is equal to zero.">operator!</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> val_ == 0; }
<a name="l00096"></a>00096 
<a name="l00099"></a><a class="code" href="classvnl__finite__int.html#a8826f5dd61b21ace00c6c2014f2364d8">00099</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a8826f5dd61b21ace00c6c2014f2364d8" title="Plus&amp;amp;assign: replace lhs by lhs + rhs.">operator+=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; r) { mo_=lp1_=0; val_ += int(r); <span class="keywordflow">if</span> (val_ &gt;= <span class="keywordtype">int</span>(N)) val_ -= N; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00100"></a><a class="code" href="classvnl__finite__int.html#a2130f95fd4c1181dff69096eab135d44">00100</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a2130f95fd4c1181dff69096eab135d44">operator+=</a>(<span class="keywordtype">int</span> r) { <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html#a5f0eae536c82bc4c67ec72cfd58da9da" title="Assignment.">operator=</a>(val_+r); }
<a name="l00103"></a><a class="code" href="classvnl__finite__int.html#a2d3ede2395b1fc6c3432cdb2694baec8">00103</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a2d3ede2395b1fc6c3432cdb2694baec8" title="Minus&amp;amp;assign: replace lhs by lhs - rhs.">operator-=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; r) { mo_=lp1_=0; val_ -= int(r); <span class="keywordflow">if</span> (val_ &lt; 0) val_ += N; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00104"></a><a class="code" href="classvnl__finite__int.html#a9ec84a76337e8542a366e2c7d0622d9a">00104</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a9ec84a76337e8542a366e2c7d0622d9a">operator-=</a>(<span class="keywordtype">int</span> r) { <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html#a5f0eae536c82bc4c67ec72cfd58da9da" title="Assignment.">operator=</a>(val_-r); }
<a name="l00107"></a><a class="code" href="classvnl__finite__int.html#a0c46a15900752ce16a7145f3418b1931">00107</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a0c46a15900752ce16a7145f3418b1931" title="Multiply&amp;amp;assign: replace lhs by lhs * rhs.">operator*=</a>(<span class="keywordtype">int</span> r) {
<a name="l00108"></a>00108     r %=N; <span class="keywordflow">if</span> (r&lt;0) r=N+r;
<a name="l00109"></a>00109     <span class="comment">// This rather complicated implementation is necessary to avoid integer overflow</span>
<a name="l00110"></a>00110     <span class="keywordflow">if</span> (N&lt;=0x7fff || (val_&lt;=0x7fff &amp;&amp; r&lt;=0x7fff)) { val_ *= r; val_ %= N; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00111"></a>00111     <span class="keywordflow">else</span> { <span class="keywordtype">int</span> <a class="code" href="matrix_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>=val_; <a class="code" href="classvnl__finite__int.html#a8826f5dd61b21ace00c6c2014f2364d8" title="Plus&amp;amp;assign: replace lhs by lhs + rhs.">operator+=</a>(v); <a class="code" href="classvnl__finite__int.html#a0c46a15900752ce16a7145f3418b1931" title="Multiply&amp;amp;assign: replace lhs by lhs * rhs.">operator*=</a>(r/2); <span class="keywordflow">if</span> (r%2) <a class="code" href="classvnl__finite__int.html#a8826f5dd61b21ace00c6c2014f2364d8" title="Plus&amp;amp;assign: replace lhs by lhs + rhs.">operator+=</a>(v); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00112"></a>00112   }
<a name="l00115"></a><a class="code" href="classvnl__finite__int.html#aea1e66d3f1fd0283d855a73ade88ea42">00115</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#aea1e66d3f1fd0283d855a73ade88ea42" title="Multiply&amp;amp;assign: replace lhs by lhs * rhs.">operator*=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; r) {
<a name="l00116"></a>00116     mo_=0;
<a name="l00117"></a>00117     <span class="keywordflow">if</span> (lp1_!=0 &amp;&amp; r.lp1_!=0) set_log(lp1_+r.lp1_-2); <span class="keywordflow">else</span> lp1_=0;
<a name="l00118"></a>00118     <span class="comment">// This rather complicated implementation is necessary to avoid integer overflow</span>
<a name="l00119"></a>00119     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s=int(r);
<a name="l00120"></a>00120     <span class="keywordflow">if</span> (N&lt;=0x7fff || (val_&lt;=0x7fff &amp;&amp; s&lt;=0x7fff)) { val_ *= s; val_ %= N; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00121"></a>00121     <span class="keywordflow">else</span> { <span class="keywordtype">int</span> <a class="code" href="matrix_8h.html#a38bf1e5e0427bdeba2b469eea9befc23">v</a>=val_; <a class="code" href="classvnl__finite__int.html#a8826f5dd61b21ace00c6c2014f2364d8" title="Plus&amp;amp;assign: replace lhs by lhs + rhs.">operator+=</a>(v); <a class="code" href="classvnl__finite__int.html#a0c46a15900752ce16a7145f3418b1931" title="Multiply&amp;amp;assign: replace lhs by lhs * rhs.">operator*=</a>(s/2); <span class="keywordflow">if</span> (s%2) <a class="code" href="classvnl__finite__int.html#a8826f5dd61b21ace00c6c2014f2364d8" title="Plus&amp;amp;assign: replace lhs by lhs + rhs.">operator+=</a>(v); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00122"></a>00122   }
<a name="l00123"></a>00123 
<a name="l00128"></a><a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080">00128</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">totient</a>() {
<a name="l00129"></a>00129     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t_ = 0; <span class="comment">// cached value</span>
<a name="l00130"></a>00130     <span class="keywordflow">if</span> (t_ != 0) <span class="keywordflow">return</span> t_;
<a name="l00131"></a>00131     std::vector&lt;unsigned int&gt; d = <a class="code" href="classvnl__finite__int.html#ad19ed518c3abf5953e905dd923050439" title="Write N as the unique product of prime factors.">decompose</a>();
<a name="l00132"></a>00132     t_ = 1; <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 1;
<a name="l00133"></a>00133     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;d.size(); ++i)
<a name="l00134"></a>00134     {
<a name="l00135"></a>00135       <span class="keywordflow">if</span> (p != d[i]) t_ *= d[i]-1;
<a name="l00136"></a>00136       <span class="keywordflow">else</span>           t_ *= d[i];
<a name="l00137"></a>00137       p = d[i];
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139     <span class="keywordflow">return</span> t_;
<a name="l00140"></a>00140   }
<a name="l00141"></a>00141 
<a name="l00145"></a><a class="code" href="classvnl__finite__int.html#a9c705d1399c417e8affe27358c9336c4">00145</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#a9c705d1399c417e8affe27358c9336c4" title="Multiplicative inverse.">reciproc</a>()<span class="keyword"> const </span>{
<a name="l00146"></a>00146     assert(<a class="code" href="classvnl__finite__int.html#a5d7182748a07d269fc4f3b6371f09b7d" title="Return true only when x is a unit in this ring.">is_unit</a>());
<a name="l00147"></a>00147     <span class="keywordflow">if</span> (val_==1) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00148"></a>00148     <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> z = <a class="code" href="classvnl__finite__int.html#a544dab210baf650f468d45d80078089d" title="Return the smallest multiplicative generator of the units in this ring.">smallest_generator</a>();
<a name="l00149"></a>00149     <span class="keywordflow">if</span> (z!=1) <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html#ab209d0f6435fd33e953ad6af6b42c17e" title="Return the inverse of log(), i.e., return g^r where g is the smallest generator.">exp</a>(<a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">Base::totient</a>()-<a class="code" href="classvnl__finite__int.html#a0097611c81c7a1a79a1ccb3b8fbfac8d" title="Return the smallest nonnegative exponent r for which x=g^r, where g is the smallest...">log</a>());
<a name="l00150"></a>00150     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r=1; r&lt;=N/2; ++r) {
<a name="l00151"></a>00151       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t=int(*<span class="keyword">this</span>*<span class="keywordtype">int</span>(r));
<a name="l00152"></a>00152       <span class="keywordflow">if</span> (t==1) <span class="keywordflow">return</span> r; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t==N-1) <span class="keywordflow">return</span> N-r;
<a name="l00153"></a>00153     }
<a name="l00154"></a>00154     <span class="keywordflow">return</span> 0; <span class="comment">// This will never be executed</span>
<a name="l00155"></a>00155   }
<a name="l00156"></a>00156 
<a name="l00159"></a><a class="code" href="classvnl__finite__int.html#a778fe6b796d2e7dda99883437e91cce5">00159</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a778fe6b796d2e7dda99883437e91cce5" title="Divide&amp;amp;assign. Uses r.reciproc() for efficient computation.">operator/=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <span class="keyword">const</span>&amp; r) {
<a name="l00160"></a>00160     assert(r.<a class="code" href="classvnl__finite__int.html#a5d7182748a07d269fc4f3b6371f09b7d" title="Return true only when x is a unit in this ring.">is_unit</a>());
<a name="l00161"></a>00161     <span class="keywordflow">return</span> val_ == 0 ? <a class="code" href="classvnl__finite__int.html#a5f0eae536c82bc4c67ec72cfd58da9da" title="Assignment.">operator=</a>(0) : <a class="code" href="classvnl__finite__int.html#a0c46a15900752ce16a7145f3418b1931" title="Multiply&amp;amp;assign: replace lhs by lhs * rhs.">operator*=</a>(r.<a class="code" href="classvnl__finite__int.html#a9c705d1399c417e8affe27358c9336c4" title="Multiplicative inverse.">reciproc</a>());
<a name="l00162"></a>00162   }
<a name="l00163"></a>00163 
<a name="l00166"></a><a class="code" href="classvnl__finite__int.html#acbd69932f167d3739feaf8f1d9eda5e1">00166</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#acbd69932f167d3739feaf8f1d9eda5e1" title="Pre-increment (++r).">operator++</a>() { mo_=lp1_=0; ++val_; <span class="keywordflow">if</span> (val_==N) val_=0; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00169"></a><a class="code" href="classvnl__finite__int.html#a603e93e59c06de3252565bcabae0ff49">00169</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a>&amp; <a class="code" href="classvnl__finite__int.html#a603e93e59c06de3252565bcabae0ff49" title="Pre-decrement (--r).">operator--</a>() { mo_=lp1_=0; <span class="keywordflow">if</span> (val_==0) val_=N; --val_; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00172"></a><a class="code" href="classvnl__finite__int.html#a690043f5b2fcb5292261f4a9240aab7d">00172</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#a690043f5b2fcb5292261f4a9240aab7d" title="Post-increment (r++).">operator++</a>(<span class="keywordtype">int</span>){<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> b=*<span class="keyword">this</span>; mo_=lp1_=0; ++val_; <span class="keywordflow">if</span> (val_==N) val_=0; <span class="keywordflow">return</span> b; }
<a name="l00175"></a><a class="code" href="classvnl__finite__int.html#a281e037d19312926d42c62c359825aee">00175</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#a281e037d19312926d42c62c359825aee" title="Post-decrement (r--).">operator--</a>(<span class="keywordtype">int</span>){<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> b=*<span class="keyword">this</span>; mo_=lp1_=0; <span class="keywordflow">if</span> (val_==0) val_=N; --val_; <span class="keywordflow">return</span> b;}
<a name="l00176"></a>00176 
<a name="l00179"></a><a class="code" href="classvnl__finite__int.html#ad19ed518c3abf5953e905dd923050439">00179</a>   <span class="keyword">static</span> std::vector&lt;unsigned int&gt; <a class="code" href="classvnl__finite__int.html#ad19ed518c3abf5953e905dd923050439" title="Write N as the unique product of prime factors.">decompose</a>() {
<a name="l00180"></a>00180     <span class="keyword">static</span> std::vector&lt;unsigned int&gt; decomposition_ = std::vector&lt;unsigned int&gt;(); <span class="comment">// cached value</span>
<a name="l00181"></a>00181     <span class="keywordflow">if</span> (decomposition_.size() &gt; 0) <span class="keywordflow">return</span> decomposition_;
<a name="l00182"></a>00182     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = N;
<a name="l00183"></a>00183     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d=2; d*d&lt;=r; ++d)
<a name="l00184"></a>00184       <span class="keywordflow">while</span> (r%d == 0) { decomposition_.push_back(d); r /= d; }
<a name="l00185"></a>00185     <span class="keywordflow">if</span> (r &gt; 1) decomposition_.push_back(r);
<a name="l00186"></a>00186     <span class="keywordflow">return</span> decomposition_;
<a name="l00187"></a>00187   }
<a name="l00188"></a>00188 
<a name="l00191"></a><a class="code" href="classvnl__finite__int.html#a39192969b26c870ee2bbd67ebc692d34">00191</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#a39192969b26c870ee2bbd67ebc692d34" title="Return true when N is a prime number, i.e., when this ring is a field.">is_field</a>() {
<a name="l00192"></a>00192     std::vector&lt;unsigned int&gt; d = <a class="code" href="classvnl__finite__int.html#ad19ed518c3abf5953e905dd923050439" title="Write N as the unique product of prime factors.">Base::decompose</a>();
<a name="l00193"></a>00193     <span class="keywordflow">return</span> d.size() == 1;
<a name="l00194"></a>00194   }
<a name="l00195"></a>00195 
<a name="l00200"></a><a class="code" href="classvnl__finite__int.html#a5d7182748a07d269fc4f3b6371f09b7d">00200</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#a5d7182748a07d269fc4f3b6371f09b7d" title="Return true only when x is a unit in this ring.">is_unit</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61" title="Calculate the greatest common divisor of l and N.">gcd</a>(val_) == 1; }
<a name="l00201"></a>00201 
<a name="l00204"></a><a class="code" href="classvnl__finite__int.html#af722ee732db59600a06b856b456622dc">00204</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int.html#af722ee732db59600a06b856b456622dc" title="Return true only when x is a zero divisor, i.e., is not a unit.">is_zero_divisor</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61" title="Calculate the greatest common divisor of l and N.">gcd</a>(val_) != 1; }
<a name="l00205"></a>00205 
<a name="l00208"></a><a class="code" href="classvnl__finite__int.html#aef5e26756faeb190f25d2eb0a48dc637">00208</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int.html#aef5e26756faeb190f25d2eb0a48dc637" title="The additive order of x is the smallest nonnegative r such that r*x == 0.">additive_order</a>()<span class="keyword"> const </span>{ <span class="keywordflow">if</span> (val_ == 0) <span class="keywordflow">return</span> 1; <span class="keywordflow">return</span> N/<a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61" title="Calculate the greatest common divisor of l and N.">gcd</a>(val_); }
<a name="l00209"></a>00209 
<a name="l00212"></a><a class="code" href="classvnl__finite__int.html#af51a20524ecbea1a9a67770e38c53497">00212</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int.html#af51a20524ecbea1a9a67770e38c53497" title="The multiplicative order of x is the smallest r (&amp;gt;0) such that x^r == 1.">multiplicative_order</a>()<span class="keyword"> const </span>{
<a name="l00213"></a>00213     <span class="keywordflow">if</span> (mo_ != 0) <span class="keywordflow">return</span> mo_;
<a name="l00214"></a>00214     <span class="keywordflow">if</span> (<a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61" title="Calculate the greatest common divisor of l and N.">gcd</a>(val_) != 1) <span class="keywordflow">return</span> -1; <span class="comment">// should actually return infinity</span>
<a name="l00215"></a>00215     <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> y = val_;
<a name="l00216"></a>00216     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=1; r&lt;N; ++r) { <span class="keywordflow">if</span> (y==1) <span class="keywordflow">return</span> mo_=r; y *= val_; }
<a name="l00217"></a>00217     <span class="keywordflow">return</span> 0; <span class="comment">// this should not happen</span>
<a name="l00218"></a>00218   }
<a name="l00219"></a>00219 
<a name="l00225"></a><a class="code" href="classvnl__finite__int.html#a544dab210baf650f468d45d80078089d">00225</a>   <span class="keyword">static</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#a544dab210baf650f468d45d80078089d" title="Return the smallest multiplicative generator of the units in this ring.">smallest_generator</a>() {
<a name="l00226"></a>00226     <span class="keyword">static</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> gen_ = 0; <span class="comment">// cached value</span>
<a name="l00227"></a>00227     <span class="keywordflow">if</span> (gen_ != 0) <span class="keywordflow">return</span> gen_;
<a name="l00228"></a>00228     <span class="keywordflow">if</span> (N==2) <span class="keywordflow">return</span> gen_=1;
<a name="l00229"></a>00229     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h = <a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">Base::totient</a>() / 2; <span class="comment">// note that totient() is always even</span>
<a name="l00230"></a>00230     <span class="keywordflow">for</span> (gen_=2; gen_!=0; ++gen_) {
<a name="l00231"></a>00231       <span class="comment">// calculate gen_^h</span>
<a name="l00232"></a>00232       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> g=h; <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> y = 1, z = gen_; <span class="keywordflow">while</span> (g&gt;0) { <span class="keywordflow">if</span> (g%2) y *= z; g/=2; z*=z; }
<a name="l00233"></a>00233       <span class="comment">// quick elimination of non-generator:</span>
<a name="l00234"></a>00234       <span class="keywordflow">if</span> (y == 1) <span class="keywordflow">continue</span>;
<a name="l00235"></a>00235       <span class="comment">// calculate gen_.multiplicative_order() only if really necessary:</span>
<a name="l00236"></a>00236       <span class="keywordflow">if</span> (gen_.<a class="code" href="classvnl__finite__int.html#af51a20524ecbea1a9a67770e38c53497" title="The multiplicative order of x is the smallest r (&amp;gt;0) such that x^r == 1.">multiplicative_order</a>() == <a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">Base::totient</a>()) { gen_.set_log(1); <span class="keywordflow">return</span> gen_; }
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238     assert(!<a class="code" href="classvnl__finite__int.html#a39192969b26c870ee2bbd67ebc692d34" title="Return true when N is a prime number, i.e., when this ring is a field.">Base::is_field</a>()); <span class="comment">// can only reach this point when N is not prime</span>
<a name="l00239"></a>00239     <span class="keywordflow">return</span> gen_=1;
<a name="l00240"></a>00240   }
<a name="l00241"></a>00241 
<a name="l00244"></a><a class="code" href="classvnl__finite__int.html#a953b12163f8ff82c5bca9f91c746fd9a">00244</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#a953b12163f8ff82c5bca9f91c746fd9a" title="Return the r-th power of this number.">pow</a>(<span class="keywordtype">int</span> r) {
<a name="l00245"></a>00245     r %= <a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">Base::totient</a>(); <span class="keywordflow">if</span> (r&lt;0) r += <a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">Base::totient</a>();
<a name="l00246"></a>00246     <span class="keywordflow">if</span> (r==0) <span class="keywordflow">return</span> 1; <span class="keywordflow">if</span> (r==1) <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00247"></a>00247     <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> y = 1, z = *<span class="keyword">this</span>; <span class="keywordtype">int</span> s=r; <span class="keywordflow">while</span> (s!=0) { <span class="keywordflow">if</span> (s%2) y*=z; s/=2; z*=z; }
<a name="l00248"></a>00248     <span class="keywordflow">if</span> (lp1_ != 0) y.set_log(r*(lp1_-1));
<a name="l00249"></a>00249     <span class="keywordflow">return</span> y;
<a name="l00250"></a>00250   }
<a name="l00251"></a>00251 
<a name="l00254"></a><a class="code" href="classvnl__finite__int.html#a0097611c81c7a1a79a1ccb3b8fbfac8d">00254</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int.html#a0097611c81c7a1a79a1ccb3b8fbfac8d" title="Return the smallest nonnegative exponent r for which x=g^r, where g is the smallest...">log</a>()<span class="keyword"> const </span>{
<a name="l00255"></a>00255     <span class="keywordflow">if</span> (<a class="code" href="classvnl__finite__int.html#af722ee732db59600a06b856b456622dc" title="Return true only when x is a zero divisor, i.e., is not a unit.">is_zero_divisor</a>()) <span class="keywordflow">return</span> -1; <span class="comment">// should actually return minus infinity</span>
<a name="l00256"></a>00256     <span class="keywordflow">if</span> (lp1_ != 0) <span class="keywordflow">return</span> lp1_-1;
<a name="l00257"></a>00257     <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> z = <a class="code" href="classvnl__finite__int.html#a544dab210baf650f468d45d80078089d" title="Return the smallest multiplicative generator of the units in this ring.">smallest_generator</a>();
<a name="l00258"></a>00258     assert(N==2||z!=1); <span class="comment">// otherwise, the units of this ring do not form a cyclic group</span>
<a name="l00259"></a>00259     <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> y = 1;
<a name="l00260"></a>00260     <span class="keywordflow">for</span> (lp1_=1; lp1_&lt;=N; ++lp1_) {
<a name="l00261"></a>00261       <span class="keywordflow">if</span> (y == *<span class="keyword">this</span>) <span class="keywordflow">return</span> lp1_-1;
<a name="l00262"></a>00262       y *= z;
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264     <span class="keywordflow">return</span> -1; <span class="comment">// should never reach this point</span>
<a name="l00265"></a>00265   }
<a name="l00266"></a>00266 
<a name="l00269"></a><a class="code" href="classvnl__finite__int.html#ab209d0f6435fd33e953ad6af6b42c17e">00269</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> <a class="code" href="classvnl__finite__int.html#ab209d0f6435fd33e953ad6af6b42c17e" title="Return the inverse of log(), i.e., return g^r where g is the smallest generator.">exp</a>(<span class="keywordtype">int</span> r) {
<a name="l00270"></a>00270     <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Base</a> z = <a class="code" href="classvnl__finite__int.html#a544dab210baf650f468d45d80078089d" title="Return the smallest multiplicative generator of the units in this ring.">smallest_generator</a>();
<a name="l00271"></a>00271     assert(N==2||z!=1); <span class="comment">// otherwise, the units of this ring do not form a cyclic group</span>
<a name="l00272"></a>00272     <span class="keywordflow">return</span> z.<a class="code" href="classvnl__finite__int.html#a953b12163f8ff82c5bca9f91c746fd9a" title="Return the r-th power of this number.">pow</a>(r);
<a name="l00273"></a>00273   }
<a name="l00274"></a>00274 
<a name="l00277"></a><a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61">00277</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61" title="Calculate the greatest common divisor of l and N.">gcd</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=N) {
<a name="l00278"></a>00278     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> l1 = n;
<a name="l00279"></a>00279     <span class="keywordflow">while</span> (l!=0) { <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t = l; l = l1 % l; l1 = t; }
<a name="l00280"></a>00280     <span class="keywordflow">return</span> l1;
<a name="l00281"></a>00281   }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283  <span class="keyword">private</span>:
<a name="l00286"></a>00286   <span class="keywordtype">void</span> set_log(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r)<span class="keyword"> const </span>{ r %= <a class="code" href="classvnl__finite__int.html#a14cab5eacb40edf2d91938c50c148080" title="Return the Euler totient function, i.e., the number of units of this ring.">Base::totient</a>(); lp1_ = r+1; }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288  <span class="keyword">private</span>:
<a name="l00289"></a>00289   <span class="keywordtype">int</span> val_; 
<a name="l00290"></a>00290   <span class="keyword">mutable</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mo_; 
<a name="l00291"></a>00291   <span class="keyword">mutable</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lp1_; 
<a name="l00292"></a>00292 };
<a name="l00293"></a>00293 
<a name="l00296"></a>00296 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00297"></a><a class="code" href="finite_8h.html#ab5dd424feb666ddb35a936a63fdd4204">00297</a> <span class="keyword">inline</span> std::ostream&amp; operator&lt;&lt; (std::ostream&amp; s, vnl_finite_int&lt;N&gt; <span class="keyword">const</span>&amp; r) {
<a name="l00298"></a>00298   <span class="keywordflow">return</span> s &lt;&lt; int(r);
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00303"></a>00303 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00304"></a><a class="code" href="finite_8h.html#ae888e2b3e43dcb5f81ed62f6fba9e93f">00304</a> <span class="keyword">inline</span> std::istream&amp; <a class="code" href="finite_8h.html#ae888e2b3e43dcb5f81ed62f6fba9e93f" title="simple input.">operator&gt;&gt; </a>(std::istream&amp; s, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a>&amp; r) {
<a name="l00305"></a>00305   <span class="keywordtype">int</span> n; s &gt;&gt; n; r=n; <span class="keywordflow">return</span> s;
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00310"></a>00310 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00311"></a><a class="code" href="finite_8h.html#a68e084074605cbc9d2dca612811ca67f">00311</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a50901bb91ad35945688ed6cf49047ebe" title="Returns the addition of two bignum numbers.">operator+ </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00312"></a>00312   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result += r2;
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00315"></a><a class="code" href="finite_8h.html#a46066cddab2a89c90c54d2a25d1e764b">00315</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a50901bb91ad35945688ed6cf49047ebe" title="Returns the addition of two bignum numbers.">operator+ </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <span class="keywordtype">int</span> r2) {
<a name="l00316"></a>00316   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result += r2;
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00319"></a><a class="code" href="finite_8h.html#aa29890c018ed1a68443c5d059f0d528e">00319</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a50901bb91ad35945688ed6cf49047ebe" title="Returns the addition of two bignum numbers.">operator+ </a>(<span class="keywordtype">int</span> r2, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1) {
<a name="l00320"></a>00320   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result += r2;
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00325"></a>00325 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00326"></a><a class="code" href="finite_8h.html#af0863543968d5c96c6ad95bb9d8be13c">00326</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a16114a846393b88dbccad70c70b41bc5" title="Returns the difference of two bignum numbers.">operator- </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00327"></a>00327   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result -= r2;
<a name="l00328"></a>00328 }
<a name="l00329"></a>00329 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00330"></a><a class="code" href="finite_8h.html#a8ad7265a4c5b1ee6bcf7036412284b54">00330</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a16114a846393b88dbccad70c70b41bc5" title="Returns the difference of two bignum numbers.">operator- </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <span class="keywordtype">int</span> r2) {
<a name="l00331"></a>00331   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result -= r2;
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00334"></a><a class="code" href="finite_8h.html#a73dcee26a38b164ee7166161c6e01996">00334</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a16114a846393b88dbccad70c70b41bc5" title="Returns the difference of two bignum numbers.">operator- </a>(<span class="keywordtype">int</span> r2, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1) {
<a name="l00335"></a>00335   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(-r1); <span class="keywordflow">return</span> result += r2;
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 
<a name="l00340"></a>00340 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00341"></a><a class="code" href="finite_8h.html#a72cb94618f58d25ca354f3ec67f1750f">00341</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="matrixinverse_8h.html#add399f78ba41177624bb3445abc9263a">operator* </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00342"></a>00342   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result *= r2;
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00345"></a><a class="code" href="finite_8h.html#a55a3abece036b889c1658db20c07131a">00345</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="matrixinverse_8h.html#add399f78ba41177624bb3445abc9263a">operator* </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <span class="keywordtype">int</span> r2) {
<a name="l00346"></a>00346   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result *= r2;
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00349"></a><a class="code" href="finite_8h.html#a813015802572946900ef103a43e4949c">00349</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="matrixinverse_8h.html#add399f78ba41177624bb3445abc9263a">operator* </a>(<span class="keywordtype">int</span> r2, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1) {
<a name="l00350"></a>00350   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result *= r2;
<a name="l00351"></a>00351 }
<a name="l00355"></a>00355 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00356"></a><a class="code" href="finite_8h.html#afcfc051396c0f603c21835cbbf50bae7">00356</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a97d6dd80dfb358ae5594db453af27e5a" title="Returns the division of two bignum numbers.">operator/</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00357"></a>00357   assert(r2.<a class="code" href="classvnl__finite__int.html#a5d7182748a07d269fc4f3b6371f09b7d" title="Return true only when x is a unit in this ring.">is_unit</a>()); <span class="keywordflow">return</span> r1 == 0 ? <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a>(0) : r1*r2.<a class="code" href="classvnl__finite__int.html#a9c705d1399c417e8affe27358c9336c4" title="Multiplicative inverse.">reciproc</a>();
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00360"></a><a class="code" href="finite_8h.html#a2a7377498432196a5d8b4952848a869e">00360</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a97d6dd80dfb358ae5594db453af27e5a" title="Returns the division of two bignum numbers.">operator/ </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r1, <span class="keywordtype">int</span> r2) {
<a name="l00361"></a>00361   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result /= r2;
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00364"></a><a class="code" href="finite_8h.html#aad0d4ca40a6a04f6e67bde1cbc95fd48">00364</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="namespaceVNL.html#a97d6dd80dfb358ae5594db453af27e5a" title="Returns the division of two bignum numbers.">operator/ </a>(<span class="keywordtype">int</span> r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00365"></a>00365   <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> result(r1); <span class="keywordflow">return</span> result /= r2;
<a name="l00366"></a>00366 }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00369"></a><a class="code" href="finite_8h.html#a864079b8c89fb26694ffb1a254b04e5d">00369</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespaceVNL.html#a53f448b218078f7c5871cd3832db4ec4">operator== </a>(<span class="keywordtype">int</span>  r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) { <span class="keywordflow">return</span> r2==r1; }
<a name="l00370"></a>00370 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00371"></a><a class="code" href="finite_8h.html#a8d47e6141911b49df42687ad0b4a69ff">00371</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="finite_8h.html#a8d47e6141911b49df42687ad0b4a69ff">operator!= </a>(<span class="keywordtype">int</span>  r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) { <span class="keywordflow">return</span> r2!=r1; }
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00374"></a><a class="code" href="finite_8h.html#aa054ec75e7e191928d598780663d1c37">00374</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="finite_8h.html#aa054ec75e7e191928d598780663d1c37">vnl_math_squared_magnitude</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; x) { <span class="keywordflow">return</span> x*x; }
<a name="l00375"></a>00375 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00376"></a><a class="code" href="finite_8h.html#add14c73ac974a8896dab8b0a8ea8a8f3">00376</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="finite_8h.html#add14c73ac974a8896dab8b0a8ea8a8f3">vnl_math_sqr</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; x) { <span class="keywordflow">return</span> x*x; }
<a name="l00377"></a>00377 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00378"></a><a class="code" href="finite_8h.html#a0e8b2735c73c5be3ba7bdbe1b954b0a3">00378</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="finite_8h.html#a0e8b2735c73c5be3ba7bdbe1b954b0a3">vnl_math_isnan</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; ){<span class="keywordflow">return</span> <span class="keyword">false</span>;}
<a name="l00379"></a>00379 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N&gt;
<a name="l00380"></a><a class="code" href="finite_8h.html#a6e7755497535e49f1b9bfd20fa39d1b0">00380</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="finite_8h.html#a6e7755497535e49f1b9bfd20fa39d1b0">vnl_math_isfinite</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; x){<span class="keywordflow">return</span> <span class="keyword">true</span>;} 
<a name="l00381"></a>00381 
<a name="l00397"></a>00397 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00398"></a><a class="code" href="classvnl__finite__int__poly.html">00398</a> <span class="keyword">class </span><a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly</a> {
<a name="l00399"></a>00399   <span class="keyword">typedef</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>;
<a name="l00400"></a>00400   <span class="keyword">typedef</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>;
<a name="l00401"></a>00401   <span class="comment">// This essentially implements std::pow(int,int) which is not always available</span>
<a name="l00402"></a>00402   <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Ntothe(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="matrix_8h.html#a00626facb4f86efb8618a4c5f5c3c5f8">m</a>) { <span class="keywordflow">return</span> m==0?1:N*Ntothe(m-1); }
<a name="l00403"></a>00403  <span class="keyword">public</span>:
<a name="l00406"></a><a class="code" href="classvnl__finite__int__poly.html#afa6a54a32a830dcf68bbed43b474007a">00406</a>   <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int__poly.html#afa6a54a32a830dcf68bbed43b474007a" title="The number of different finite_int polynomials of this type.">cardinality</a>() { <span class="keywordflow">return</span> Ntothe(M); }
<a name="l00407"></a>00407 
<a name="l00410"></a><a class="code" href="classvnl__finite__int__poly.html#a03cbb6e211d01c3d9fee9a16be5ffe38">00410</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html#a03cbb6e211d01c3d9fee9a16be5ffe38" title="Creates a general finite_int_poly.">vnl_finite_int_poly</a>(std::vector&lt;Scalar&gt; <span class="keyword">const</span>&amp; p) : val_(p) { assert(N&gt;1); assert(M&gt;0); assert(p.size()&lt;=M); }
<a name="l00413"></a><a class="code" href="classvnl__finite__int__poly.html#a502ccde6a04bccbad163ee476fa381ca">00413</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html#a502ccde6a04bccbad163ee476fa381ca" title="Creates a degree 0 finite_int_poly.">vnl_finite_int_poly</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> <span class="keyword">const</span>&amp; n) : val_(std::vector&lt;<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>&gt;(1)) { assert(N&gt;1); assert(M&gt;0); val_[0]=n; }
<a name="l00416"></a><a class="code" href="classvnl__finite__int__poly.html#abdae1ece4b4da1842eaaf49d2c531f26">00416</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html#abdae1ece4b4da1842eaaf49d2c531f26" title="Default constructor. Creates a degree 0 finite_int_poly equal to 0.">vnl_finite_int_poly</a>() : val_(std::vector&lt;<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>&gt;(1)) { assert(N&gt;1); assert(M&gt;0); val_[0]=0; }
<a name="l00417"></a>00417   <span class="comment">//  Copy constructor</span>
<a name="l00418"></a><a class="code" href="classvnl__finite__int__poly.html#a2b9fe0c50a00158780bb41948347f0bf">00418</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html#a2b9fe0c50a00158780bb41948347f0bf">vnl_finite_int_poly</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; x) : val_(x.val_) {}
<a name="l00419"></a>00419   <span class="comment">//  Destructor</span>
<a name="l00420"></a><a class="code" href="classvnl__finite__int__poly.html#a057b32bba1dac3916ddb12b6dedc67cd">00420</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html#a057b32bba1dac3916ddb12b6dedc67cd">~vnl_finite_int_poly</a>() {}
<a name="l00421"></a>00421 
<a name="l00424"></a><a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75">00424</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> val_.size() - 1; }
<a name="l00425"></a>00425 
<a name="l00428"></a><a class="code" href="classvnl__finite__int__poly.html#af0f03314b47ca2293ce85008b4e341be">00428</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int__poly.html#af0f03314b47ca2293ce85008b4e341be" title="Effective degree of this polynomial; equals -1 when this polynomial is 0.">degree</a>()<span class="keyword"> const </span>{ <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); i&gt;=0; --i) <span class="keywordflow">if</span> (val_[i]!=0) <span class="keywordflow">return</span> i; <span class="keywordflow">return</span> -1; }
<a name="l00429"></a>00429 
<a name="l00432"></a><a class="code" href="classvnl__finite__int__poly.html#a510467005e11f5ebcd47884f8bc7c8ca">00432</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> <a class="code" href="classvnl__finite__int__poly.html#a510467005e11f5ebcd47884f8bc7c8ca" title="Access to individual coefficients.">operator[]</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i)<span class="keyword"> const </span>{ assert(i&lt;M); <span class="keywordflow">return</span> i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>() ? val_[i] : <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(0); }
<a name="l00433"></a>00433 
<a name="l00436"></a><a class="code" href="classvnl__finite__int__poly.html#a7ab3159c9321bf72cb477878d0b8bd06">00436</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>&amp; <a class="code" href="classvnl__finite__int__poly.html#a7ab3159c9321bf72cb477878d0b8bd06" title="Assignment.">operator=</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; x) { val_ = x.val_; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00437"></a><a class="code" href="classvnl__finite__int__poly.html#a8414e5c31b387b57db18fb9a33561f46">00437</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>&amp; <a class="code" href="classvnl__finite__int__poly.html#a8414e5c31b387b57db18fb9a33561f46">operator=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> <span class="keyword">const</span>&amp; n) { val_ = std::vector&lt;Scalar&gt;(1); val_[0] = n; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00438"></a>00438 
<a name="l00441"></a><a class="code" href="classvnl__finite__int__poly.html#ada8fe03c0190f61a6082d09e560a6eca">00441</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int__poly.html#ada8fe03c0190f61a6082d09e560a6eca" title="Comparison of finite int polys.">operator==</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; x)<span class="keyword"> const </span>{
<a name="l00442"></a>00442     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i)
<a name="l00443"></a>00443       <span class="keywordflow">if</span> (val_[i] != x[i]) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00444"></a>00444     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>()+1; i&lt;=x.<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i)
<a name="l00445"></a>00445       <span class="keywordflow">if</span> (x[i] != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00446"></a>00446     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00447"></a>00447   }
<a name="l00448"></a><a class="code" href="classvnl__finite__int__poly.html#aea37741f8a3e04cd7fc3789f743cc66a">00448</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int__poly.html#aea37741f8a3e04cd7fc3789f743cc66a">operator!=</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="classvnl__finite__int__poly.html#ada8fe03c0190f61a6082d09e560a6eca" title="Comparison of finite int polys.">operator==</a>(x); }
<a name="l00449"></a><a class="code" href="classvnl__finite__int__poly.html#ad3d90225099f7bdbe1b65d0e6e04fcde">00449</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int__poly.html#ad3d90225099f7bdbe1b65d0e6e04fcde">operator==</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> <span class="keyword">const</span>&amp; x)<span class="keyword"> const </span>{
<a name="l00450"></a>00450     <span class="keywordflow">if</span> (x!=val_[0]) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00451"></a>00451     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=1; i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i) <span class="keywordflow">if</span> (val_[i] != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00452"></a>00452     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00453"></a>00453   }
<a name="l00454"></a><a class="code" href="classvnl__finite__int__poly.html#a5b448e0ea1444d61950be9a5b32f51b3">00454</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int__poly.html#a5b448e0ea1444d61950be9a5b32f51b3">operator!=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> <span class="keyword">const</span>&amp; x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="classvnl__finite__int__poly.html#ada8fe03c0190f61a6082d09e560a6eca" title="Comparison of finite int polys.">operator==</a>(x); }
<a name="l00455"></a>00455 
<a name="l00458"></a><a class="code" href="classvnl__finite__int__poly.html#a9fcb01d295f2703787246740154bb6c3">00458</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <a class="code" href="classvnl__finite__int__poly.html#a9fcb01d295f2703787246740154bb6c3" title="Unary minus - returns the additive inverse.">operator-</a>()<span class="keyword"> const </span>{ std::vector&lt;Scalar&gt; p = val_; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;p.size(); ++i) p[i]=-p[i]; <span class="keywordflow">return</span> p; }
<a name="l00461"></a><a class="code" href="classvnl__finite__int__poly.html#a4d90edef5b202180db07dd70a6fc7a96">00461</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <a class="code" href="classvnl__finite__int__poly.html#a4d90edef5b202180db07dd70a6fc7a96" title="Unary plus - returns the current polynomial.">operator+</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00464"></a><a class="code" href="classvnl__finite__int__poly.html#a969a1697b1c35b12d670aa3dfa55a80a">00464</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int__poly.html#a969a1697b1c35b12d670aa3dfa55a80a" title="Unary not - returns true if finite int poly is equal to zero.">operator!</a>()<span class="keyword"> const </span>{ <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i) <span class="keywordflow">if</span> (val_[i] != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00465"></a>00465 
<a name="l00468"></a><a class="code" href="classvnl__finite__int__poly.html#add7774d6de48668086f6b9dfec115af5">00468</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>&amp; <a class="code" href="classvnl__finite__int__poly.html#add7774d6de48668086f6b9dfec115af5" title="Plus&amp;amp;assign: replace lhs by lhs + rhs.">operator+=</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; r) {
<a name="l00469"></a>00469     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=r.<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i)
<a name="l00470"></a>00470       <span class="keywordflow">if</span> (i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>()) val_[i] += r[i];
<a name="l00471"></a>00471       <span class="keywordflow">else</span>          val_.push_back(r[i]);
<a name="l00472"></a>00472     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00473"></a>00473   }
<a name="l00476"></a><a class="code" href="classvnl__finite__int__poly.html#a978be2e53927dba446d192cfc6d6aefe">00476</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>&amp; <a class="code" href="classvnl__finite__int__poly.html#a978be2e53927dba446d192cfc6d6aefe" title="Minus&amp;amp;assign: replace lhs by lhs - rhs.">operator-=</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; r) {
<a name="l00477"></a>00477     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=r.<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i)
<a name="l00478"></a>00478       <span class="keywordflow">if</span> (i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>()) val_[i] -= r[i];
<a name="l00479"></a>00479       <span class="keywordflow">else</span>          val_.push_back(-r[i]);
<a name="l00480"></a>00480     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00481"></a>00481   }
<a name="l00482"></a>00482 
<a name="l00485"></a><a class="code" href="classvnl__finite__int__poly.html#a1bdaac8f40b4aee6294a587e57809eee">00485</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>&amp; <a class="code" href="classvnl__finite__int__poly.html#a1bdaac8f40b4aee6294a587e57809eee" title="Scalar multiple of this.">operator*=</a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> <span class="keyword">const</span>&amp; n) { <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i) val_[i] *= n; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00486"></a>00486 
<a name="l00489"></a><a class="code" href="classvnl__finite__int__poly.html#accab56bab42dc4aba8eaed6509c5c162">00489</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int__poly.html#accab56bab42dc4aba8eaed6509c5c162" title="The additive order of x is the smallest positive r such that r*x == 0.">additive_order</a>()<span class="keyword"> const </span>{
<a name="l00490"></a>00490     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> r = N;
<a name="l00491"></a>00491     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++i)
<a name="l00492"></a>00492       <span class="keywordflow">if</span> (val_[i] != 0) r=<a class="code" href="classvnl__finite__int.html#ad2aa0d89571e737406dc56b5954dbc61" title="Calculate the greatest common divisor of l and N.">Scalar::gcd</a>(val_[i],r);
<a name="l00493"></a>00493     <span class="keywordflow">return</span> N/r;
<a name="l00494"></a>00494   }
<a name="l00495"></a>00495 
<a name="l00500"></a><a class="code" href="classvnl__finite__int__poly.html#add1da04c45b7b9e8ded4ea930cc31065">00500</a>   <span class="keyword">static</span> std::vector&lt;Scalar&gt;&amp; <a class="code" href="classvnl__finite__int__poly.html#add1da04c45b7b9e8ded4ea930cc31065" title="get/set the (irreducible) modulo polynomial of degree M.">modulo_polynomial</a>(std::vector&lt;Scalar&gt; p = std::vector&lt;Scalar&gt;())
<a name="l00501"></a>00501   {
<a name="l00502"></a>00502     <span class="keyword">static</span> std::vector&lt;Scalar&gt; poly_(M+1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(0));
<a name="l00503"></a>00503     <span class="keywordflow">if</span> (p.size() == 0) { <span class="comment">// retrieval</span>
<a name="l00504"></a>00504       assert(poly_[M] != 0); <span class="comment">// cannot retrieve before having set</span>
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506     <span class="keywordflow">else</span>
<a name="l00507"></a>00507     {
<a name="l00508"></a>00508       assert(p.size() == M+1 &amp;&amp; p[M].is_unit());<span class="comment">// must be of effective degree M</span>
<a name="l00509"></a>00509       <span class="comment">// Now set poly_, thereby making the coefficient poly_[M] equal to -1.</span>
<a name="l00510"></a>00510       <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a> f = -1/p[M];
<a name="l00511"></a>00511       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;=M; ++m) poly_[m] = f*p[m];
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513     <span class="keywordflow">return</span> poly_;
<a name="l00514"></a>00514   }
<a name="l00515"></a>00515 
<a name="l00518"></a><a class="code" href="classvnl__finite__int__poly.html#ac58b07a5a7394f8357740d2015397cb9">00518</a>   <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>&amp; <a class="code" href="classvnl__finite__int__poly.html#ac58b07a5a7394f8357740d2015397cb9" title="Multiply&amp;amp;assign: replace lhs by lhs * rhs, modulo the &amp;quot;modulo&amp;quot; polynomial...">operator*=</a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <span class="keyword">const</span>&amp; r) {
<a name="l00519"></a>00519     <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> x = *<span class="keyword">this</span>; *<span class="keyword">this</span> = r; *<span class="keyword">this</span> *= x[0];
<a name="l00520"></a>00520     <span class="keywordflow">while</span> (val_.size() &lt; M) val_.push_back(0);
<a name="l00521"></a>00521     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=x.<a class="code" href="classvnl__finite__int__poly.html#af0f03314b47ca2293ce85008b4e341be" title="Effective degree of this polynomial; equals -1 when this polynomial is 0.">degree</a>(); ++i)
<a name="l00522"></a>00522       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;=r.<a class="code" href="classvnl__finite__int__poly.html#a300609bd9a1b9a58dc2bb7e030356c75" title="Formal degree of this polynomial.">deg</a>(); ++j)
<a name="l00523"></a>00523         add_modulo_poly(i+j, x[i]*r[j]);
<a name="l00524"></a>00524     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00525"></a>00525   }
<a name="l00526"></a>00526 
<a name="l00529"></a><a class="code" href="classvnl__finite__int__poly.html#a30ee7c22188a9b12fb7df3ebdd32aed2">00529</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classvnl__finite__int__poly.html#a30ee7c22188a9b12fb7df3ebdd32aed2" title="Return the multiplicative order of this polynomial.">multiplicative_order</a>()<span class="keyword"> const </span>{
<a name="l00530"></a>00530     <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> t = <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(1);
<a name="l00531"></a>00531     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> order = 0;
<a name="l00532"></a>00532     <span class="keywordflow">do</span> t *= *<span class="keyword">this</span>, ++order; <span class="keywordflow">while</span> (t != <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(1) &amp;&amp; t != <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(0));
<a name="l00533"></a>00533     <span class="keywordflow">return</span> t==<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(1) ? order : -1;
<a name="l00534"></a>00534   }
<a name="l00535"></a>00535 
<a name="l00540"></a><a class="code" href="classvnl__finite__int__poly.html#acff35d157952395d5e9fb2e0445e7998">00540</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classvnl__finite__int__poly.html#acff35d157952395d5e9fb2e0445e7998" title="Return true when this ring is a field.">is_field</a>() {
<a name="l00541"></a>00541     <span class="keywordflow">if</span> (!<a class="code" href="classvnl__finite__int.html#a39192969b26c870ee2bbd67ebc692d34" title="Return true when N is a prime number, i.e., when this ring is a field.">Scalar::is_field</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00542"></a>00542 
<a name="l00543"></a>00543     std::vector&lt;Scalar&gt; mod_p = <a class="code" href="classvnl__finite__int__poly.html#add1da04c45b7b9e8ded4ea930cc31065" title="get/set the (irreducible) modulo polynomial of degree M.">Base::modulo_polynomial</a>();
<a name="l00544"></a>00544     mod_p.pop_back(); <span class="comment">// remove the &quot;-1&quot; coefficient of X^M</span>
<a name="l00545"></a>00545     <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>(mod_p).multiplicative_order()+1 == <a class="code" href="classvnl__finite__int__poly.html#afa6a54a32a830dcf68bbed43b474007a" title="The number of different finite_int polynomials of this type.">Base::cardinality</a>();
<a name="l00546"></a>00546   }
<a name="l00547"></a>00547 
<a name="l00553"></a><a class="code" href="classvnl__finite__int__poly.html#aa37e1a0485248d0a18273c9e70856782">00553</a>   <span class="keyword">static</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a> <a class="code" href="classvnl__finite__int__poly.html#aa37e1a0485248d0a18273c9e70856782" title="Return the smallest multiplicative generator of the units in this ring.">smallest_generator</a>() {
<a name="l00554"></a>00554     <span class="keywordflow">if</span> (!<a class="code" href="classvnl__finite__int__poly.html#acff35d157952395d5e9fb2e0445e7998" title="Return true when this ring is a field.">Base::is_field</a>()) <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">Scalar</a>(1);
<a name="l00555"></a>00555     std::vector&lt;Scalar&gt; mod_p = <a class="code" href="classvnl__finite__int__poly.html#add1da04c45b7b9e8ded4ea930cc31065" title="get/set the (irreducible) modulo polynomial of degree M.">Base::modulo_polynomial</a>();
<a name="l00556"></a>00556     mod_p.pop_back(); <span class="comment">// remove the &quot;-1&quot; coefficient of X^M</span>
<a name="l00557"></a>00557     <span class="keywordflow">return</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">Base</a>(mod_p);
<a name="l00558"></a>00558   }
<a name="l00559"></a>00559 
<a name="l00560"></a>00560  <span class="keyword">private</span>:
<a name="l00561"></a>00561   std::vector&lt;Scalar&gt; val_; 
<a name="l00562"></a>00562 
<a name="l00565"></a>00565   <span class="keyword">inline</span> <span class="keywordtype">void</span> add_modulo_poly(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m, Scalar <span class="keyword">const</span>&amp; x)
<a name="l00566"></a>00566   {
<a name="l00567"></a>00567     <span class="keywordflow">if</span> (m &lt; M) val_[m] += x;
<a name="l00568"></a>00568     <span class="keywordflow">else</span> {
<a name="l00569"></a>00569       std::vector&lt;Scalar&gt; p = <a class="code" href="classvnl__finite__int__poly.html#add1da04c45b7b9e8ded4ea930cc31065" title="get/set the (irreducible) modulo polynomial of degree M.">modulo_polynomial</a>(); <span class="comment">// where p[M] == -1</span>
<a name="l00570"></a>00570       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;M; ++k) add_modulo_poly(m-M+k, x*p[k]); <span class="comment">// recursive call</span>
<a name="l00571"></a>00571     }
<a name="l00572"></a>00572   }
<a name="l00573"></a>00573 };
<a name="l00574"></a>00574 
<a name="l00577"></a>00577 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00578"></a><a class="code" href="finite_8h.html#a9a7ebeb719e6fb9d962ae078bfd7e213">00578</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <a class="code" href="namespaceVNL.html#a50901bb91ad35945688ed6cf49047ebe" title="Returns the addition of two bignum numbers.">operator+ </a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00579"></a>00579   <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> result=r1; <span class="keywordflow">return</span> result += r2;
<a name="l00580"></a>00580 }
<a name="l00581"></a>00581 
<a name="l00584"></a>00584 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00585"></a><a class="code" href="finite_8h.html#a17d52403e63ac465fd6d0a18970aeef9">00585</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <a class="code" href="namespaceVNL.html#a16114a846393b88dbccad70c70b41bc5" title="Returns the difference of two bignum numbers.">operator- </a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00586"></a>00586   <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> result=r1; <span class="keywordflow">return</span> result -= r2;
<a name="l00587"></a>00587 }
<a name="l00588"></a>00588 
<a name="l00591"></a>00591 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00592"></a><a class="code" href="finite_8h.html#a3efffc49e0bfc273d695770cb34a54b3">00592</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <a class="code" href="matrixinverse_8h.html#add399f78ba41177624bb3445abc9263a">operator* </a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00593"></a>00593   <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> result(r1); <span class="keywordflow">return</span> result *= r2;
<a name="l00594"></a>00594 }
<a name="l00595"></a>00595 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00596"></a><a class="code" href="finite_8h.html#a7cff187188ef0fb61c94211c69396dd1">00596</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <a class="code" href="matrixinverse_8h.html#add399f78ba41177624bb3445abc9263a">operator* </a>(<a class="code" href="classvnl__finite__int.html" title="finite modulo-N arithmetic.">vnl_finite_int&lt;N&gt;</a> <span class="keyword">const</span>&amp; r2, <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r1) {
<a name="l00597"></a>00597   <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> result(r1); <span class="keywordflow">return</span> result *= r2;
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00604"></a>00604 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00605"></a><a class="code" href="finite_8h.html#aeb8e4d6fd0b0772c01b5c36c0718036f">00605</a> <span class="keyword">inline</span> <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <a class="code" href="matrixinverse_8h.html#add399f78ba41177624bb3445abc9263a">operator* </a>(<a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r1, <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> <span class="keyword">const</span>&amp; r2) {
<a name="l00606"></a>00606   <a class="code" href="classvnl__finite__int__poly.html" title="finite modulo-N arithmetic with polynomials of degree &amp;lt; M.">vnl_finite_int_poly&lt;N,M&gt;</a> result(r1); <span class="keywordflow">return</span> result *= r2;
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00611"></a>00611 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keywordtype">int</span> M&gt;
<a name="l00612"></a><a class="code" href="finite_8h.html#a892eec9b95565b98850d3c7dce202612">00612</a> <span class="keyword">inline</span> std::ostream&amp; operator&lt;&lt; (std::ostream&amp; s, vnl_finite_int_poly&lt;N,M&gt; <span class="keyword">const</span>&amp; r) {
<a name="l00613"></a>00613   <span class="keywordtype">bool</span> out = <span class="keyword">false</span>;
<a name="l00614"></a>00614   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;=r.deg(); ++i) {
<a name="l00615"></a>00615     <span class="keywordflow">if</span> (r[i] == 0) <span class="keywordflow">continue</span>;
<a name="l00616"></a>00616     <span class="keywordflow">if</span> (out) s &lt;&lt; <span class="charliteral">&apos;+&apos;</span>;
<a name="l00617"></a>00617     out = <span class="keyword">true</span>;
<a name="l00618"></a>00618     <span class="keywordflow">if</span> (r[i] != 1 || i==0) s &lt;&lt; r[i];
<a name="l00619"></a>00619     <span class="keywordflow">if</span> (i&gt;0) s &lt;&lt; <span class="charliteral">&apos;X&apos;</span>;
<a name="l00620"></a>00620     <span class="keywordflow">if</span> (i&gt;1) s &lt;&lt; <span class="charliteral">&apos;^&apos;</span> &lt;&lt; i;
<a name="l00621"></a>00621   }
<a name="l00622"></a>00622   <span class="keywordflow">if</span> (!out) s &lt;&lt; <span class="charliteral">&apos;0&apos;</span>;
<a name="l00623"></a>00623   <span class="keywordflow">return</span> s;
<a name="l00624"></a>00624 }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 <span class="preprocessor">#endif // vnl_finite_h_</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Mar 21 09:55:45 2010 for VW by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
