<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>VW: imagebase.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen_vw.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
  <div class="navpath"><a class="el" href="dir_e94aa2d94ffcbebccfddf7d325860958.html">VW</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_66e06ba48ba6171520928e488381f96f.html">Image</a>
  </div>
<div class="contents">
<h1>imagebase.h</h1><a href="imagebase_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00049"></a>00049 <span class="preprocessor">#ifndef _baseimage_h_</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">#define _baseimage_h_</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>
<a name="l00052"></a>00052 <span class="comment">// C-style includes</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;math.h&gt;</span> <span class="comment">// for sqrt</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00056"></a>00056 <span class="comment">// C++ includes</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">// Local includes</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="roi_8h.html">roi.h</a>&quot;</span>
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="keyword">namespace </span>VW {
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; 
<a name="l00067"></a><a class="code" href="classVW_1_1ImageBase.html">00067</a>   <span class="keyword">class </span><a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">ImageBase</a> {
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="keyword">public</span>:
<a name="l00071"></a>00071        
<a name="l00072"></a>00072     <a class="code" href="classVW_1_1ImageBase.html#a73e5f6fd645893f49a4d917115c83753" title="Construct without allocating storage.">ImageBase</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h);
<a name="l00073"></a>00073     <a class="code" href="classVW_1_1ImageBase.html#a73e5f6fd645893f49a4d917115c83753" title="Construct without allocating storage.">ImageBase</a>(PixelType* data, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h);
<a name="l00074"></a>00074     <a class="code" href="classVW_1_1ImageBase.html#a73e5f6fd645893f49a4d917115c83753" title="Construct without allocating storage.">ImageBase</a>();
<a name="l00075"></a>00075 
<a name="l00076"></a>00076     <span class="keyword">virtual</span> <a class="code" href="classVW_1_1ImageBase.html#a7f0b7f42124c32821a05365b0ab0a176">~ ImageBase</a>();
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a775913a7ae3099642941cee5105984d8" title="Allocate the image data array.">AllocImageData</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h);
<a name="l00079"></a>00079     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#ab9f905bb6e54da428980c0b0d041d7ee" title="Allocate the image data array using some existing data.">SetImageData</a>(PixelType* data, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h);
<a name="l00080"></a>00080     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a2b7843a9aaf65cd821114bceeeb9a459" title="De-allocate the image data array.">FreeImageData</a>();
<a name="l00081"></a>00081 
<a name="l00082"></a>00082     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#ae55398d3347ca6d0bf09d31ffa377f94" title="Is the image data array allocated?">IsAlloced</a>() <span class="keyword">const</span>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#ad17d92bdf8d1503240edf366c412bfe4" title="Get width and height in a single command.">GetSize</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;w, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;h) <span class="keyword">const</span>;
<a name="l00085"></a>00085     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classVW_1_1ImageBase.html#a9f368c36735f1c0aa7f38b3dabca3443" title="Determine the width of the image in pixels.">GetWidth</a>(<span class="keywordtype">void</span>) <span class="keyword">const</span>;
<a name="l00086"></a>00086     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classVW_1_1ImageBase.html#a7a46adca57aaaa0d31d8110eb33a55e1" title="Determine the height of the image in pixels.">GetHeight</a>(<span class="keywordtype">void</span>) <span class="keyword">const</span>;
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a8df948f1e59fef84345702491d24ef19" title="Set the region of interest (ROI) of the image.">SetROI</a>(<span class="keyword">const</span> <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a> &amp; new_roi);
<a name="l00089"></a>00089 <span class="comment">//     VW::ROI GetROI() const;</span>
<a name="l00090"></a>00090     <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a>&amp; <a class="code" href="classVW_1_1ImageBase.html#ad3c5525c3be57cacfe5c49ad4a3ca982" title="Copy of the region of interest (ROI) of the image.">ROI</a>();
<a name="l00091"></a>00091     <span class="keyword">const</span> <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a>&amp; <a class="code" href="classVW_1_1ImageBase.html#ad3c5525c3be57cacfe5c49ad4a3ca982" title="Copy of the region of interest (ROI) of the image.">ROI</a>() <span class="keyword">const</span>;
<a name="l00092"></a>00092 
<a name="l00094"></a>00094     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#ade9ee9d1010e2f28efaa7fcc75444d71" title="Set the ROI to be the whole image.">ResetROI</a>();
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     PixelType *<a class="code" href="classVW_1_1ImageBase.html#a69a0b777b6c3d758960668503edc38d4" title="Get a pointer to the first pixel in the data array.">GetImageBuffer</a>(<span class="keywordtype">void</span>) <span class="keyword">const</span>;
<a name="l00097"></a>00097     <span class="keywordtype">void</span> *<a class="code" href="classVW_1_1ImageBase.html#ac6c11f83f14a996ef73d9dc4593fac1d" title="Get a pointer to the first memory location used in the data array.">GetRawBuffer</a>(<span class="keywordtype">void</span>) <span class="keyword">const</span>;
<a name="l00098"></a>00098     PixelType <a class="code" href="classVW_1_1ImageBase.html#acc79d8c5d68eeda58e4e5e8523acad28" title="Recover (copy) the pixel at column c, row r.">GetPixel</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> r) <span class="keyword">const</span>;
<a name="l00099"></a>00099     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a1fca3bef82e64fb678813d3f4767bb99" title="Set the pixel at column c, row r.">SetPixel</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> c, <span class="keyword">const</span> <span class="keywordtype">int</span> r, <span class="keyword">const</span> PixelType &amp; new_value);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     PixelPtr  <a class="code" href="classVW_1_1ImageBase.html#a54ce2a9eb7ae56b110bcda6d5812a922">GetRowStart</a>(<span class="keywordtype">int</span> r) <span class="keyword">const</span>;
<a name="l00102"></a>00102     PixelPtr* <a class="code" href="classVW_1_1ImageBase.html#ae95e2065a210c1757817b1d4159bfc18">GetRowPointer</a>(<span class="keywordtype">int</span> r) <span class="keyword">const</span>;
<a name="l00103"></a>00103     PixelPtr  <a class="code" href="classVW_1_1ImageBase.html#ad6cdb96360998efa7c646e22b01c4e18">operator[] </a>(<span class="keywordtype">int</span> r) <span class="keyword">const</span>; <span class="comment">// same as GetRowStart()</span>
<a name="l00104"></a>00104     PixelPtr  <a class="code" href="classVW_1_1ImageBase.html#a07e911a6a370e44702ff9f2fc4b52b92">GetROIRowStart</a>(<span class="keywordtype">int</span> r) <span class="keyword">const</span>;
<a name="l00105"></a>00105 
<a name="l00107"></a>00107     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#adc1efaa14d67190b658b1afcc63207ec" title="Set the whole image to a particular value.">Clear</a>(<span class="keyword">const</span> PixelType &amp; new_value = PixelType());
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#a5a5d089f0736a68aca0a913d2fe62211" title="Read a standard image format from disk.">ReadImage</a>(<span class="keyword">const</span> std::string&amp; filename);
<a name="l00110"></a>00110     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#af93be544ff5ef4b29f92708d4efc4d72" title="Write a standard image format to disk.">WriteImage</a>(<span class="keyword">const</span> std::string&amp; filename) <span class="keyword">const</span>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <span class="comment">// Some basic transformations</span>
<a name="l00113"></a>00113     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a140ebf09c2e4f970779fee55f5b845d9" title="Flip the image horizontally (size preserved).">FlipHorizontal</a>();
<a name="l00114"></a>00114     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a395ec59318c62b76c4f5d3496fb8532d" title="Flip the image vertically (size preserved).">FlipVertical</a>();
<a name="l00115"></a>00115 
<a name="l00130"></a>00130     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a06b024ef62cd4edc779fdd1e1c3da187" title="Swap this image&amp;#39;s data for other image data - size, ROI etc are also exchanged...">ExchangeData</a>(<a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">ImageBase&lt;PixelType,PixelPtr&gt;</a>&amp; other);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="comment">// Streaming ops</span>
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#a33a6435d097192c887a97d8b88576de8" title="Read the image from a stream in the internal VW format.">ReadBinary</a>(std::istream&amp; stream);
<a name="l00136"></a>00136     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#a95119f20e224408317483436c299f030" title="Write the image to a stream in the internal VW format.">WriteBinary</a>(std::ostream&amp; stream) <span class="keyword">const</span>;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     PixelType <a class="code" href="classVW_1_1ImageBase.html#abd06db981c6e55b8612b0035c48b7137" title="Get the pixel at the start of row r.">operator() </a>(<span class="keywordtype">int</span> r) <span class="keyword">const</span>;
<a name="l00140"></a>00140     PixelType <a class="code" href="classVW_1_1ImageBase.html#abd06db981c6e55b8612b0035c48b7137" title="Get the pixel at the start of row r.">operator() </a>(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> c);
<a name="l00141"></a>00141 
<a name="l00148"></a><a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b">00148</a>     PixelPtr *<a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>;
<a name="l00149"></a>00149 
<a name="l00151"></a>00151     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#ad09335787afbf6e63d3e20ee1d39a384" title="For drawing, the image has a pen colour much like a display.">SetPenColour</a>(<span class="keyword">const</span> PixelType&amp; colour);
<a name="l00152"></a>00152 
<a name="l00154"></a>00154     PixelType <a class="code" href="classVW_1_1ImageBase.html#a9b13a2a240266bd3f20dd8fd605c78b8" title="Return the current pen colour.">GetPenColour</a>() <span class="keyword">const</span>;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#abec0fcb5e6258a6d4afa789590841770">DrawLine</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x0, <span class="keyword">const</span> <span class="keywordtype">double</span> y0,
<a name="l00157"></a>00157       <span class="keyword">const</span> <span class="keywordtype">double</span> x1, <span class="keyword">const</span> <span class="keywordtype">double</span> y1);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159   <span class="keyword">protected</span>:
<a name="l00160"></a>00160     <span class="comment">// Funcs</span>
<a name="l00161"></a>00161 
<a name="l00165"></a>00165    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#a1a4997b6774b35dc360de4108d0696d5" title="Return strings describing the format of image data.">GetFormatStrings</a>(std::string&amp; format, 
<a name="l00166"></a>00166          std::string&amp; type) <span class="keyword">const</span> = 0;
<a name="l00167"></a>00167 
<a name="l00171"></a>00171     <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">ImageBase</a> &amp; <a class="code" href="classVW_1_1ImageBase.html#ad1aba14f2e6da3e139a9b7c335c09a93" title="Operator= is dangerous and has been disabled.">operator=</a>(<span class="keyword">const</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">ImageBase</a> &amp; im)
<a name="l00172"></a>00172 ;
<a name="l00176"></a>00176     <a class="code" href="classVW_1_1ImageBase.html#a73e5f6fd645893f49a4d917115c83753" title="Construct without allocating storage.">ImageBase</a>(<span class="keyword">const</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">ImageBase</a> &amp;);
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html#af1198f757c39857b6ccb47f054ea983f">_CreateRowPointers</a>();
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="comment">// Data</span>
<a name="l00182"></a><a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">00182</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;  <span class="comment">// width of image</span>
<a name="l00183"></a><a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">00183</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>; <span class="comment">// height of image</span>
<a name="l00184"></a>00184     
<a name="l00185"></a><a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">00185</a>     <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a> <a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">_roi</a>;   <span class="comment">// Region of interest</span>
<a name="l00186"></a>00186     
<a name="l00187"></a>00187     
<a name="l00188"></a><a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">00188</a>     PixelType *<a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00189"></a><a class="code" href="classVW_1_1ImageBase.html#a314d2d92cbcc37dfa141e782a10870d5">00189</a>     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#a314d2d92cbcc37dfa141e782a10870d5">_dataalloced</a>;  <span class="comment">// has memory been allocated</span>
<a name="l00190"></a><a class="code" href="classVW_1_1ImageBase.html#a67612e9794dd995503cdc71f282e62a2">00190</a>     <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html#a67612e9794dd995503cdc71f282e62a2">_rowsalloced</a>;  <span class="comment">// has memory been allocated</span>
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="comment">// For drawing on images like displays</span>
<a name="l00193"></a><a class="code" href="classVW_1_1ImageBase.html#ab5f598c39b39418a477509ff589a633e">00193</a>     PixelType <a class="code" href="classVW_1_1ImageBase.html#ab5f598c39b39418a477509ff589a633e">_pen_colour</a>;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195   };
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 };        <span class="comment">// end namespace VW</span>
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="comment">// Inlines</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 
<a name="l00223"></a>00223 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; <span class="keyword">inline</span> 
<a name="l00224"></a><a class="code" href="classVW_1_1ImageBase.html#ad78a9bb62f1a9087ad55b1c50c18a2b9">00224</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;::ImageBase</a>(PixelType* data, 
<a name="l00225"></a>00225              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w,
<a name="l00226"></a>00226              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h)
<a name="l00227"></a>00227   : _data(data), _dataalloced(<span class="keyword">false</span>), _rowsalloced(<span class="keyword">false</span>)
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229   assert(data != 0 &amp;&amp; w != 0 &amp;&amp; h != 0);
<a name="l00230"></a>00230   _width = w;
<a name="l00231"></a>00231   _height = h;
<a name="l00232"></a>00232   _roi.Set(0, 0, _width, _height);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   _CreateRowPointers();
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   _dataalloced = <span class="keyword">false</span>;
<a name="l00237"></a>00237   _rowsalloced = <span class="keyword">true</span>;
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 
<a name="l00245"></a>00245 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; <span class="keyword">inline</span> 
<a name="l00246"></a><a class="code" href="classVW_1_1ImageBase.html#a4b0842216c81280db4c8302ee174b182">00246</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType,PixelPtr &gt;::ImageBase</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, 
<a name="l00247"></a>00247             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h)
<a name="l00248"></a>00248   : _dataalloced(<span class="keyword">false</span>), _rowsalloced(<span class="keyword">false</span>)
<a name="l00249"></a>00249 {
<a name="l00250"></a>00250   assert(w != 0 &amp;&amp; h != 0);
<a name="l00251"></a>00251   _width = w;
<a name="l00252"></a>00252   _height = h;
<a name="l00253"></a>00253   _roi.Set(0, 0, _width, _height);
<a name="l00254"></a>00254   AllocImageData(_width, _height);
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 
<a name="l00262"></a>00262 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; <span class="keyword">inline</span> 
<a name="l00263"></a><a class="code" href="classVW_1_1ImageBase.html#a73e5f6fd645893f49a4d917115c83753">00263</a>   <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;::ImageBase</a>()
<a name="l00264"></a>00264     :  pixel(0),
<a name="l00265"></a>00265      _width(0),
<a name="l00266"></a>00266      _height(0),
<a name="l00267"></a>00267      _roi(0, 0, _width, _height),
<a name="l00268"></a>00268      _data(0),
<a name="l00269"></a>00269      _dataalloced(<span class="keyword">false</span>),
<a name="l00270"></a>00270      _rowsalloced(<span class="keyword">false</span>)
<a name="l00271"></a>00271 {
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00278"></a>00278 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00279"></a><a class="code" href="classVW_1_1ImageBase.html#a775913a7ae3099642941cee5105984d8">00279</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType,PixelPtr &gt;::AllocImageData</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, 
<a name="l00280"></a>00280                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h)
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282   _width = w;
<a name="l00283"></a>00283   _height = h;
<a name="l00284"></a>00284   _data = <span class="keyword">new</span> PixelType[_width * _height];
<a name="l00285"></a>00285   _CreateRowPointers();
<a name="l00286"></a>00286   assert(_data != NULL &amp;&amp; pixel != NULL);
<a name="l00287"></a>00287 
<a name="l00288"></a>00288   _roi.Set(0, 0, _width, _height);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   _dataalloced = <span class="keyword">true</span>;
<a name="l00291"></a>00291   _rowsalloced = <span class="keyword">true</span>;
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 
<a name="l00299"></a>00299 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00300"></a><a class="code" href="classVW_1_1ImageBase.html#ab9f905bb6e54da428980c0b0d041d7ee">00300</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType,PixelPtr &gt;::SetImageData</a>(PixelType* data, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> h)
<a name="l00301"></a>00301 {
<a name="l00302"></a>00302   assert(data != 0 &amp;&amp; w != 0 &amp;&amp; h != 0);
<a name="l00303"></a>00303   _width = w;
<a name="l00304"></a>00304   _height = h;
<a name="l00305"></a>00305   _data = data;
<a name="l00306"></a>00306   _roi.Set(0, 0, _width, _height);
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   _CreateRowPointers();
<a name="l00309"></a>00309 
<a name="l00310"></a>00310   _dataalloced = <span class="keyword">false</span>;
<a name="l00311"></a>00311   _rowsalloced = <span class="keyword">true</span>;
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00316"></a><a class="code" href="classVW_1_1ImageBase.html#a7f0b7f42124c32821a05365b0ab0a176">00316</a> <span class="keyword">inline</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;</a>::~ImageBase()
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (_dataalloced) {
<a name="l00319"></a>00319     FreeImageData();
<a name="l00320"></a>00320   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_rowsalloced) {
<a name="l00321"></a>00321     <span class="keyword">delete</span>[] pixel;
<a name="l00322"></a>00322     _rowsalloced = <span class="keyword">false</span>;
<a name="l00323"></a>00323   }
<a name="l00324"></a>00324 }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 
<a name="l00332"></a>00332 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00333"></a><a class="code" href="classVW_1_1ImageBase.html#a2b7843a9aaf65cd821114bceeeb9a459">00333</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;::FreeImageData</a>()
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335   assert(_dataalloced &amp;&amp; _rowsalloced &amp;&amp; _data != NULL &amp;&amp; pixel != NULL);
<a name="l00336"></a>00336   <span class="keyword">delete</span>[] _data;
<a name="l00337"></a>00337   <span class="keyword">delete</span>[] pixel;
<a name="l00338"></a>00338   _dataalloced = <span class="keyword">false</span>;
<a name="l00339"></a>00339   _rowsalloced = <span class="keyword">false</span>;
<a name="l00340"></a>00340   _width = 0;
<a name="l00341"></a>00341   _height = 0;
<a name="l00342"></a>00342   _roi.Set(0,0,0,0);
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 
<a name="l00349"></a>00349 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00350"></a>00350 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00351"></a><a class="code" href="classVW_1_1ImageBase.html#a8df948f1e59fef84345702491d24ef19">00351</a>           PixelPtr &gt;::SetROI(<span class="keyword">const</span> <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a> &amp; new_roi)
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353   _roi.Set(new_roi);
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00359"></a>00359 <span class="comment">// template &lt; class PixelType, class PixelPtr &gt;</span>
<a name="l00360"></a>00360 <span class="comment">// inline VW::ROI VW::ImageBase &lt; PixelType, PixelPtr &gt;::GetROI() const</span>
<a name="l00361"></a>00361 <span class="comment">// {</span>
<a name="l00362"></a>00362 <span class="comment">//   return _roi;</span>
<a name="l00363"></a>00363 <span class="comment">// }</span>
<a name="l00364"></a>00364 
<a name="l00368"></a>00368 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00369"></a><a class="code" href="classVW_1_1ImageBase.html#ad3c5525c3be57cacfe5c49ad4a3ca982">00369</a> <span class="keyword">inline</span> <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a> &amp; <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;::ROI</a>()
<a name="l00370"></a>00370 {
<a name="l00371"></a>00371   <span class="keywordflow">return</span> _roi;
<a name="l00372"></a>00372 }
<a name="l00373"></a>00373 
<a name="l00377"></a>00377 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00378"></a>00378 <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a> &amp; <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00379"></a><a class="code" href="classVW_1_1ImageBase.html#a590da89672f10a2878068cf963c26a0b">00379</a>                PixelPtr &gt;<a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">::ROI</a>() <span class="keyword">const</span>
<a name="l00380"></a>00380 {
<a name="l00381"></a>00381   <span class="keywordflow">return</span> _roi;
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00392"></a>00392 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00393"></a>00393 <span class="keyword">inline</span> PixelType * <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00394"></a><a class="code" href="classVW_1_1ImageBase.html#a69a0b777b6c3d758960668503edc38d4">00394</a>            PixelPtr &gt;::GetImageBuffer(void) <span class="keyword">const</span>
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396   <span class="keywordflow">return</span> _data;
<a name="l00397"></a>00397 };
<a name="l00398"></a>00398 
<a name="l00404"></a>00404 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00405"></a>00405 <span class="keyword">inline</span> <span class="keywordtype">void</span> *<a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00406"></a><a class="code" href="classVW_1_1ImageBase.html#ac6c11f83f14a996ef73d9dc4593fac1d">00406</a>            PixelPtr &gt;::GetRawBuffer(void) <span class="keyword">const</span>
<a name="l00407"></a>00407 {
<a name="l00408"></a>00408   <span class="keywordflow">return</span> static_cast &lt; <span class="keywordtype">void</span> *&gt;(_data);
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00418"></a>00418 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00419"></a>00419 <span class="keyword">inline</span> PixelType <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00420"></a><a class="code" href="classVW_1_1ImageBase.html#acc79d8c5d68eeda58e4e5e8523acad28">00420</a>          PixelPtr &gt;::GetPixel(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> r) <span class="keyword">const</span>
<a name="l00421"></a>00421 {
<a name="l00422"></a>00422 <span class="preprocessor">#ifdef _VWDEBUG</span>
<a name="l00423"></a>00423 <span class="preprocessor"></span>  <span class="keyword">using namespace </span>std;
<a name="l00424"></a>00424   <span class="keywordflow">if</span> ((<a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>&lt;0) || (<a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>&gt;=_width)) {
<a name="l00425"></a>00425     cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::GetPixel: Column &quot;</span>
<a name="l00426"></a>00426         &lt;&lt; <a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a> &lt;&lt; <span class="stringliteral">&quot;is out of bounds.&quot;</span> &lt;&lt; endl;
<a name="l00427"></a>00427     cerr &lt;&lt; <span class="stringliteral">&quot;                         (valid range is 0&lt;c&lt;&quot;</span>
<a name="l00428"></a>00428         &lt;&lt; _width &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt;endl;
<a name="l00429"></a>00429     exit(0);
<a name="l00430"></a>00430   }
<a name="l00431"></a>00431   <span class="keywordflow">if</span> ((r&lt;0) || (r&gt;=_height)) {
<a name="l00432"></a>00432     cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::GetPixel: Row &quot;</span>
<a name="l00433"></a>00433         &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;is out of bounds.&quot;</span> &lt;&lt; endl;
<a name="l00434"></a>00434     cerr &lt;&lt; <span class="stringliteral">&quot;                         (valid range is 0&lt;r&lt;&quot;</span>
<a name="l00435"></a>00435         &lt;&lt; _height &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt;endl;
<a name="l00436"></a>00436     exit(0);
<a name="l00437"></a>00437   }
<a name="l00438"></a>00438 <span class="preprocessor">#endif</span>
<a name="l00439"></a>00439 <span class="preprocessor"></span>  <span class="keywordflow">return</span> pixel[r][<a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>];
<a name="l00440"></a>00440 };
<a name="l00441"></a>00441 
<a name="l00448"></a>00448 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00449"></a>00449 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00450"></a><a class="code" href="classVW_1_1ImageBase.html#a1fca3bef82e64fb678813d3f4767bb99">00450</a>           PixelPtr &gt;::SetPixel(<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> r,
<a name="l00451"></a>00451              <span class="keyword">const</span> PixelType &amp; new_value)
<a name="l00452"></a>00452 {
<a name="l00453"></a>00453 <span class="preprocessor">#ifdef _VWDEGBUG</span>
<a name="l00454"></a>00454 <span class="preprocessor"></span>  <span class="keyword">using namespace </span>std;
<a name="l00455"></a>00455   <span class="keywordflow">if</span> ((<a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>&lt;0) || (<a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>&gt;=_width)) {
<a name="l00456"></a>00456     cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::SetPixel: Column &quot;</span>
<a name="l00457"></a>00457         &lt;&lt; <a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a> &lt;&lt; <span class="stringliteral">&quot;is out of bounds.&quot;</span> &lt;&lt; endl;
<a name="l00458"></a>00458     cerr &lt;&lt; <span class="stringliteral">&quot;                         (valid range is 0&lt;c&lt;&quot;</span>
<a name="l00459"></a>00459         &lt;&lt; _width &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt;endl;
<a name="l00460"></a>00460     exit(0);
<a name="l00461"></a>00461   }
<a name="l00462"></a>00462   <span class="keywordflow">if</span> ((r&lt;0) || (r&gt;=_height)) {
<a name="l00463"></a>00463     cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::SetPixel: Row &quot;</span>
<a name="l00464"></a>00464         &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;is out of bounds.&quot;</span> &lt;&lt; endl;
<a name="l00465"></a>00465     cerr &lt;&lt; <span class="stringliteral">&quot;                         (valid range is 0&lt;r&lt;&quot;</span>
<a name="l00466"></a>00466         &lt;&lt; _height &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt;endl;
<a name="l00467"></a>00467     exit(0);
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469 <span class="preprocessor">#endif</span>
<a name="l00470"></a>00470 <span class="preprocessor"></span>  pixel[r][<a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a>] = new_value;
<a name="l00471"></a>00471 };
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00474"></a>00474 <span class="keyword">inline</span> PixelPtr <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00475"></a><a class="code" href="classVW_1_1ImageBase.html#a54ce2a9eb7ae56b110bcda6d5812a922">00475</a>         PixelPtr &gt;::GetRowStart(<span class="keywordtype">int</span> r) <span class="keyword">const</span>
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477   <span class="keywordflow">return</span> pixel[r];
<a name="l00478"></a>00478 }
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00481"></a>00481 <span class="keyword">inline</span> PixelPtr* <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00482"></a><a class="code" href="classVW_1_1ImageBase.html#ae95e2065a210c1757817b1d4159bfc18">00482</a>         PixelPtr &gt;::GetRowPointer(<span class="keywordtype">int</span> r) <span class="keyword">const</span>
<a name="l00483"></a>00483 {
<a name="l00484"></a>00484   <span class="keywordflow">return</span> pixel + r;
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00488"></a>00488 <span class="keyword">inline</span> PixelPtr <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00489"></a><a class="code" href="classVW_1_1ImageBase.html#ad6cdb96360998efa7c646e22b01c4e18">00489</a>         PixelPtr &gt;::operator[](<span class="keywordtype">int</span> r)
<a name="l00490"></a>00490   <span class="keyword">const</span> {
<a name="l00491"></a>00491   <span class="keywordflow">return</span> pixel[r];
<a name="l00492"></a>00492 };
<a name="l00493"></a>00493 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00494"></a>00494 <span class="keyword">inline</span> PixelPtr <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00495"></a><a class="code" href="classVW_1_1ImageBase.html#a07e911a6a370e44702ff9f2fc4b52b92">00495</a>         PixelPtr &gt;::GetROIRowStart(<span class="keywordtype">int</span> r) <span class="keyword">const</span>
<a name="l00496"></a>00496 {
<a name="l00497"></a>00497   <span class="keywordflow">return</span> GetRowStart(r) + _roi.Left();
<a name="l00498"></a>00498 };
<a name="l00499"></a>00499 
<a name="l00505"></a>00505 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00506"></a>00506 <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00507"></a><a class="code" href="classVW_1_1ImageBase.html#a5a5d089f0736a68aca0a913d2fe62211">00507</a>           PixelPtr &gt;<a class="code" href="namespaceVW.html#ab543b3d2a769d54aa6ea25e6f41caed5">::ReadImage</a>(<span class="keyword">const</span> std::string&amp; filename)
<a name="l00508"></a>00508 {
<a name="l00509"></a>00509   std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::ReadImage: Base class ReadImage called in error!&quot;</span> &lt;&lt; std::endl;
<a name="l00510"></a>00510   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00511"></a>00511 };
<a name="l00512"></a>00512 
<a name="l00518"></a>00518 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00519"></a>00519 <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00520"></a><a class="code" href="classVW_1_1ImageBase.html#af93be544ff5ef4b29f92708d4efc4d72">00520</a>           PixelPtr &gt;<a class="code" href="namespaceVW.html#a1a8d968d756c7c9037668904221f2826">::WriteImage</a>(<span class="keyword">const</span> std::string&amp; filename) <span class="keyword">const</span>
<a name="l00521"></a>00521 {
<a name="l00522"></a>00522   std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::WriteImage: Base class WriteImage called in error!&quot;</span> &lt;&lt; std::endl;
<a name="l00523"></a>00523   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00524"></a>00524 };
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 
<a name="l00531"></a>00531 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00532"></a>00532 <span class="keyword">inline</span> PixelType <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00533"></a><a class="code" href="classVW_1_1ImageBase.html#abd06db981c6e55b8612b0035c48b7137">00533</a>          PixelPtr &gt;::operator()(<span class="keywordtype">int</span> r)<span class="keyword"></span>
<a name="l00534"></a>00534 <span class="keyword">  const </span>{
<a name="l00535"></a>00535   <span class="keywordflow">return</span> <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[r];
<a name="l00536"></a>00536 };
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 
<a name="l00544"></a>00544 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00545"></a>00545 <span class="keyword">inline</span> PixelType <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00546"></a><a class="code" href="classVW_1_1ImageBase.html#a1940b0218218dd903412b4c2a5242e48">00546</a>          PixelPtr &gt;::operator()(<span class="keywordtype">int</span> r, <span class="keywordtype">int</span> c)
<a name="l00547"></a>00547 {
<a name="l00548"></a>00548   <span class="keywordflow">return</span> <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[r][c];
<a name="l00549"></a>00549 };
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 
<a name="l00555"></a>00555 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00556"></a><a class="code" href="classVW_1_1ImageBase.html#ae55398d3347ca6d0bf09d31ffa377f94">00556</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;::IsAlloced</a>() <span class="keyword">const</span>
<a name="l00557"></a>00557 {
<a name="l00558"></a>00558   <span class="keywordflow">return</span> _rowsalloced;
<a name="l00559"></a>00559 };        <span class="comment">// has memory been allocated</span>
<a name="l00560"></a>00560 
<a name="l00565"></a>00565 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00566"></a>00566 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00567"></a><a class="code" href="classVW_1_1ImageBase.html#ad17d92bdf8d1503240edf366c412bfe4">00567</a>           PixelPtr &gt;::GetSize(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;w, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp;h) <span class="keyword">const</span>
<a name="l00568"></a>00568 {
<a name="l00569"></a>00569   w = _width;
<a name="l00570"></a>00570   h = _height;
<a name="l00571"></a>00571 };
<a name="l00572"></a>00572 
<a name="l00576"></a>00576 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00577"></a>00577 <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00578"></a><a class="code" href="classVW_1_1ImageBase.html#a9f368c36735f1c0aa7f38b3dabca3443">00578</a>             PixelPtr &gt;::GetWidth(void) <span class="keyword">const</span>
<a name="l00579"></a>00579 {
<a name="l00580"></a>00580   <span class="keywordflow">return</span> _width;
<a name="l00581"></a>00581 };
<a name="l00582"></a>00582 
<a name="l00586"></a>00586 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00587"></a>00587 <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00588"></a><a class="code" href="classVW_1_1ImageBase.html#a7a46adca57aaaa0d31d8110eb33a55e1">00588</a>             PixelPtr &gt;::GetHeight(void) <span class="keyword">const</span>
<a name="l00589"></a>00589 {
<a name="l00590"></a>00590   <span class="keywordflow">return</span> _height;
<a name="l00591"></a>00591 };
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt; 
<a name="l00596"></a>00596 <span class="keyword">inline</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;</a>&amp;
<a name="l00597"></a><a class="code" href="classVW_1_1ImageBase.html#ad1aba14f2e6da3e139a9b7c335c09a93">00597</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType, PixelPtr &gt;::operator</a>=(<span class="keyword">const</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt; PixelType, PixelPtr &gt;</a>&amp; im) {
<a name="l00598"></a>00598   std::cerr &lt;&lt; <span class="stringliteral">&quot;NEVER call operator= on an image!\n&quot;</span> 
<a name="l00599"></a>00599       &lt;&lt; <span class="stringliteral">&quot; (use VW::ImageCopy() instead)\n&quot;</span>;
<a name="l00600"></a>00600   exit(1);
<a name="l00601"></a>00601   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00602"></a>00602 };
<a name="l00603"></a>00603 
<a name="l00604"></a>00604 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00605"></a>00605 <span class="keyword">inline</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a> &lt; PixelType,
<a name="l00606"></a><a class="code" href="classVW_1_1ImageBase.html#a703463022753eb558bccd2f458d82a8e">00606</a>            PixelPtr &gt;<a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">::ImageBase</a>(<span class="keyword">const</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase</a>&lt; PixelType,
<a name="l00607"></a>00607            PixelPtr &gt;&amp;) {
<a name="l00608"></a>00608   std::cerr &lt;&lt; <span class="stringliteral">&quot;NEVER call the copy constructor for an image!\n &quot;</span>
<a name="l00609"></a>00609       &lt;&lt; <span class="stringliteral">&quot;(use VW::ImageCopy() instead)\n&quot;</span>;
<a name="l00610"></a>00610   exit(1);
<a name="l00611"></a>00611 }
<a name="l00612"></a>00612 
<a name="l00614"></a>00614 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00615"></a>00615 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00616"></a><a class="code" href="classVW_1_1ImageBase.html#adc1efaa14d67190b658b1afcc63207ec">00616</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType,PixelPtr &gt;::Clear</a>(<span class="keyword">const</span> PixelType &amp; new_value)
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numpix = _width * _height;
<a name="l00619"></a>00619   PixelPtr ptr = _data;
<a name="l00620"></a>00620   --ptr;
<a name="l00621"></a>00621   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; numpix; ++i)
<a name="l00622"></a>00622     *(++ptr) = new_value;
<a name="l00623"></a>00623 }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 
<a name="l00632"></a>00632 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00633"></a>00633 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00634"></a><a class="code" href="classVW_1_1ImageBase.html#a95119f20e224408317483436c299f030">00634</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType,PixelPtr &gt;::WriteBinary</a>(std::ostream&amp; stream) <span class="keyword">const</span>
<a name="l00635"></a>00635 {
<a name="l00636"></a>00636   <span class="comment">// First stick on a comment</span>
<a name="l00637"></a>00637   stream &lt;&lt; <span class="stringliteral">&quot;# This is a VW raw image&quot;</span> &lt;&lt; std::endl;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639   <span class="comment">// then a format string (Type dependent)</span>
<a name="l00640"></a>00640   std::string format,type;
<a name="l00641"></a>00641   GetFormatStrings(format,type);
<a name="l00642"></a>00642   stream &lt;&lt; format &lt;&lt; std::endl 
<a name="l00643"></a>00643    &lt;&lt; type &lt;&lt; std::endl;
<a name="l00644"></a>00644 
<a name="l00645"></a>00645   <span class="comment">// then the size</span>
<a name="l00646"></a>00646   stream &lt;&lt; _width &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; _height &lt;&lt; std::endl;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648   <span class="comment">// Now the data</span>
<a name="l00649"></a>00649   std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::WriteBinary: Going to write (&quot;</span>&lt;&lt; _width 
<a name="l00650"></a>00650       &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt;  _height &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(PixelType) 
<a name="l00651"></a>00651       &lt;&lt; <span class="stringliteral">&quot;) bytes.&quot;</span> &lt;&lt; std::endl;
<a name="l00652"></a>00652   <span class="keywordtype">char</span>* ptr = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(GetRawBuffer());
<a name="l00653"></a>00653   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numbytes = _width*_height*<span class="keyword">sizeof</span>(PixelType);
<a name="l00654"></a>00654 
<a name="l00655"></a>00655   stream.write(ptr,numbytes);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657   <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00667"></a>00667 <span class="keyword">template</span> &lt; <span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr &gt;
<a name="l00668"></a>00668 <span class="keyword">inline</span> <span class="keywordtype">bool</span> 
<a name="l00669"></a><a class="code" href="classVW_1_1ImageBase.html#a33a6435d097192c887a97d8b88576de8">00669</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase &lt; PixelType,PixelPtr &gt;::ReadBinary</a>(std::istream&amp; stream)
<a name="l00670"></a>00670 {
<a name="l00671"></a>00671   std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::ReadBinary:&quot;</span> &lt;&lt; std::endl;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   <span class="comment">// First skip the comment line</span>
<a name="l00674"></a>00674   <span class="keywordtype">char</span> line[100];
<a name="l00675"></a>00675   stream.getline(line,100);
<a name="l00676"></a>00676 
<a name="l00677"></a>00677   <span class="comment">// Try to read the image format</span>
<a name="l00678"></a>00678   std::string myformat,mytype;
<a name="l00679"></a>00679   std::string fileformat,filetype;
<a name="l00680"></a>00680   GetFormatStrings(myformat,mytype);
<a name="l00681"></a>00681 
<a name="l00682"></a>00682   stream &gt;&gt; fileformat;
<a name="l00683"></a>00683   <span class="keywordflow">if</span> (fileformat != myformat) {
<a name="l00684"></a>00684     std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::ReadBinary: Incorrect image format - \&quot;&quot;</span> &lt;&lt; fileformat 
<a name="l00685"></a>00685         &lt;&lt; <span class="stringliteral">&quot;\&quot; should be \&quot;&quot;</span> &lt;&lt; myformat &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;
<a name="l00686"></a>00686     exit(0);
<a name="l00687"></a>00687   }
<a name="l00688"></a>00688   std::cerr &lt;&lt; <span class="stringliteral">&quot;   Got format, look for type...&quot;</span> &lt;&lt; std::endl;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690   stream &gt;&gt; filetype;
<a name="l00691"></a>00691   <span class="keywordflow">if</span> (filetype != mytype) {
<a name="l00692"></a>00692     std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::ReadBinary: Incorrect image type - \&quot;&quot;</span> &lt;&lt; filetype 
<a name="l00693"></a>00693         &lt;&lt; <span class="stringliteral">&quot;\&quot; should be \&quot;&quot;</span> &lt;&lt; mytype &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span> &lt;&lt; std::endl;
<a name="l00694"></a>00694     exit(0);
<a name="l00695"></a>00695   }
<a name="l00696"></a>00696   std::cerr &lt;&lt; <span class="stringliteral">&quot;   Got type, look for size...&quot;</span> &lt;&lt; std::endl;
<a name="l00697"></a>00697   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> w,h;
<a name="l00698"></a>00698   stream &gt;&gt; w &gt;&gt; h;
<a name="l00699"></a>00699 
<a name="l00700"></a>00700   <span class="keywordflow">if</span> (IsAlloced()) {
<a name="l00701"></a>00701   <span class="keywordflow">if</span> ((w != GetWidth()) || (h != GetHeight())) {
<a name="l00702"></a>00702     std::cerr &lt;&lt; <span class="stringliteral">&quot;VW::ImageBase::ReadBinary: Size mismatch - image is (&quot;</span>
<a name="l00703"></a>00703         &lt;&lt; GetWidth() &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt;  GetHeight() &lt;&lt; <span class="stringliteral">&quot;) but file is (&quot;</span> 
<a name="l00704"></a>00704         &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; h &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;
<a name="l00705"></a>00705     exit(0);    
<a name="l00706"></a>00706   }
<a name="l00707"></a>00707   } <span class="keywordflow">else</span> {
<a name="l00708"></a>00708     AllocImageData(w, h);
<a name="l00709"></a>00709   }
<a name="l00710"></a>00710   std::cerr &lt;&lt; <span class="stringliteral">&quot;   Reading data of size (&quot;</span>&lt;&lt; w &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; h &lt;&lt; <span class="stringliteral">&quot;x&quot;</span>
<a name="l00711"></a>00711       &lt;&lt; <span class="keyword">sizeof</span>(PixelType) &lt;&lt;<span class="stringliteral">&quot;)...&quot;</span> &lt;&lt; std::endl;
<a name="l00712"></a>00712   
<a name="l00713"></a>00713 
<a name="l00714"></a>00714   <span class="comment">// Skip one char</span>
<a name="l00715"></a>00715    <span class="keywordtype">char</span> <a class="code" href="qr_8tpp.html#aafc737ea9ef91f59cf9acd287fb8d085">c</a> = stream.get();
<a name="l00716"></a>00716 
<a name="l00717"></a>00717   <span class="comment">// Now the data</span>
<a name="l00718"></a>00718    <span class="keywordtype">char</span>* ptr = <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(GetRawBuffer());
<a name="l00719"></a>00719    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numbytes = GetWidth()*GetHeight()*<span class="keyword">sizeof</span>(PixelType);
<a name="l00720"></a>00720 
<a name="l00721"></a>00721    stream.read(ptr,numbytes);
<a name="l00722"></a>00722    <span class="keywordflow">return</span>(<span class="keyword">true</span>);
<a name="l00723"></a>00723 }
<a name="l00724"></a>00724 
<a name="l00726"></a>00726 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt;
<a name="l00727"></a>00727 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00728"></a><a class="code" href="classVW_1_1ImageBase.html#ade9ee9d1010e2f28efaa7fcc75444d71">00728</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::ResetROI</a>()
<a name="l00729"></a>00729 {
<a name="l00730"></a>00730   <a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">_roi</a>.<a class="code" href="classVW_1_1ROI.html#ae753eca44be21e00267d3c6289d29d42" title="Set to an existing region of interest (eg when copying images).">Set</a>(0,0,<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>,<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>);
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 
<a name="l00735"></a>00735 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt;
<a name="l00736"></a>00736 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00737"></a><a class="code" href="classVW_1_1ImageBase.html#a140ebf09c2e4f970779fee55f5b845d9">00737</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::FlipHorizontal</a>()
<a name="l00738"></a>00738 {
<a name="l00739"></a>00739   <span class="keywordflow">if</span> (<a class="code" href="classVW_1_1ImageBase.html#ae55398d3347ca6d0bf09d31ffa377f94" title="Is the image data array allocated?">IsAlloced</a>()) {
<a name="l00740"></a>00740 
<a name="l00741"></a>00741     <span class="comment">// Reserve some space</span>
<a name="l00742"></a>00742     PixelType *new_data = <span class="keyword">new</span> PixelType[<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a> * <a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>];
<a name="l00743"></a>00743     
<a name="l00744"></a>00744     <span class="comment">// Do the copy</span>
<a name="l00745"></a>00745     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row=0; row&lt;<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>; row++) {
<a name="l00746"></a>00746       PixelType *source_ptr = &amp;(<a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>[row*<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>]);
<a name="l00747"></a>00747       PixelType *dest_ptr = &amp;(new_data[(row+1)*<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a> - 1]);
<a name="l00748"></a>00748       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> col=0; col&lt;<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>; col++, source_ptr++, dest_ptr--)
<a name="l00749"></a>00749   *dest_ptr = *source_ptr;
<a name="l00750"></a>00750     }
<a name="l00751"></a>00751     
<a name="l00752"></a>00752     <span class="comment">// Reset the data pointers</span>
<a name="l00753"></a>00753     <span class="keyword">delete</span>[] <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00754"></a>00754     <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a> = new_data;
<a name="l00755"></a>00755     <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[0] = <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00756"></a>00756     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; _height; i++) {
<a name="l00757"></a>00757       <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[i] = <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[i - 1] + <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759   }
<a name="l00760"></a>00760 }
<a name="l00761"></a>00761 
<a name="l00762"></a>00762 
<a name="l00764"></a>00764 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt;
<a name="l00765"></a>00765 <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00766"></a><a class="code" href="classVW_1_1ImageBase.html#a395ec59318c62b76c4f5d3496fb8532d">00766</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::FlipVertical</a>()
<a name="l00767"></a>00767 {
<a name="l00768"></a>00768   <span class="keywordflow">if</span> (<a class="code" href="classVW_1_1ImageBase.html#ae55398d3347ca6d0bf09d31ffa377f94" title="Is the image data array allocated?">IsAlloced</a>()) {
<a name="l00769"></a>00769 
<a name="l00770"></a>00770   <span class="comment">// We shift whole rows at a time to take advantage of CPU block copies</span>
<a name="l00771"></a>00771   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_bytes = <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a> * <span class="keyword">sizeof</span>(PixelType);
<a name="l00772"></a>00772   
<a name="l00773"></a>00773   <span class="comment">// Reserve some space</span>
<a name="l00774"></a>00774   PixelType *new_data = <span class="keyword">new</span> PixelType[<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a> * <a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>];
<a name="l00775"></a>00775   
<a name="l00776"></a>00776   <span class="comment">// Do the copy</span>
<a name="l00777"></a>00777   PixelType *source_ptr = <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00778"></a>00778   PixelType *dest_ptr = &amp;(new_data[<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>*(<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>-1)]); <span class="comment">// bottom row</span>
<a name="l00779"></a>00779   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row=0; row&lt;<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>; row++) {
<a name="l00780"></a>00780     memcpy(dest_ptr, source_ptr, num_bytes);
<a name="l00781"></a>00781     source_ptr += <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;
<a name="l00782"></a>00782     dest_ptr -= <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;
<a name="l00783"></a>00783   }
<a name="l00784"></a>00784   
<a name="l00785"></a>00785   <span class="comment">// Reset the data pointers</span>
<a name="l00786"></a>00786   <span class="keyword">delete</span>[] <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00787"></a>00787   <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a> = new_data;
<a name="l00788"></a>00788   <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[0] = <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00789"></a>00789   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; _height; i++) {
<a name="l00790"></a>00790     <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[i] = <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[i - 1] + <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;
<a name="l00791"></a>00791   }
<a name="l00792"></a>00792   }
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt;
<a name="l00796"></a><a class="code" href="classVW_1_1ImageBase.html#a06b024ef62cd4edc779fdd1e1c3da187">00796</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::ExchangeData</a>(<a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">ImageBase&lt;PixelType,PixelPtr&gt;</a>&amp; other)
<a name="l00797"></a>00797 {
<a name="l00798"></a>00798   <span class="comment">// First swap the sizes</span>
<a name="l00799"></a>00799   { 
<a name="l00800"></a>00800     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t=0;
<a name="l00801"></a>00801     t=this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;  this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>  = other.<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;  other.<a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a> = t;
<a name="l00802"></a>00802     t=this-&gt;<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>; this-&gt;<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a> = other.<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>; other.<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a> = t;
<a name="l00803"></a>00803   }
<a name="l00804"></a>00804   
<a name="l00805"></a>00805   <span class="comment">// and then the ROI</span>
<a name="l00806"></a>00806   {
<a name="l00807"></a>00807     <a class="code" href="classVW_1_1ROI.html" title="Class to hold the bounds on the Region of Interest (ROI) of a 2D array (image).">VW::ROI</a> t = this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">_roi</a>; this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">_roi</a> = other.<a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">_roi</a>; other.<a class="code" href="classVW_1_1ImageBase.html#a9e4de2f34354b8835f9006954ed6edff">_roi</a> = t;
<a name="l00808"></a>00808   }
<a name="l00809"></a>00809    
<a name="l00810"></a>00810    <span class="comment">// And the flags</span>
<a name="l00811"></a>00811   {
<a name="l00812"></a>00812     <span class="keywordtype">bool</span> t = this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a314d2d92cbcc37dfa141e782a10870d5">_dataalloced</a>; 
<a name="l00813"></a>00813     this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a314d2d92cbcc37dfa141e782a10870d5">_dataalloced</a> = other.<a class="code" href="classVW_1_1ImageBase.html#a314d2d92cbcc37dfa141e782a10870d5">_dataalloced</a>; 
<a name="l00814"></a>00814     other.<a class="code" href="classVW_1_1ImageBase.html#a314d2d92cbcc37dfa141e782a10870d5">_dataalloced</a> = t;
<a name="l00815"></a>00815   }
<a name="l00816"></a>00816 
<a name="l00817"></a>00817   <span class="comment">// now the data pointers</span>
<a name="l00818"></a>00818   {
<a name="l00819"></a>00819     PixelType* t = this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>; this-&gt;<a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a> = other.<a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>; other.<a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a> = t;
<a name="l00820"></a>00820     this-&gt;<a class="code" href="classVW_1_1ImageBase.html#af1198f757c39857b6ccb47f054ea983f">_CreateRowPointers</a>();
<a name="l00821"></a>00821     other.<a class="code" href="classVW_1_1ImageBase.html#af1198f757c39857b6ccb47f054ea983f">_CreateRowPointers</a>();
<a name="l00822"></a>00822   }
<a name="l00823"></a>00823 }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00826"></a><a class="code" href="classVW_1_1ImageBase.html#af1198f757c39857b6ccb47f054ea983f">00826</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::_CreateRowPointers</a>()
<a name="l00827"></a>00827   {
<a name="l00828"></a>00828     <span class="keywordflow">if</span> (<a class="code" href="classVW_1_1ImageBase.html#a67612e9794dd995503cdc71f282e62a2">_rowsalloced</a>) {
<a name="l00829"></a>00829       <span class="keyword">delete</span>[] <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>;
<a name="l00830"></a>00830     }
<a name="l00831"></a>00831     <span class="keywordflow">if</span> (<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>&gt;0) {
<a name="l00832"></a>00832       <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a> = <span class="keyword">new</span> PixelPtr[<a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>];
<a name="l00833"></a>00833       <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[0] = <a class="code" href="classVW_1_1ImageBase.html#a82893c0e80edde12361089097d76f914">_data</a>;
<a name="l00834"></a>00834       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classVW_1_1ImageBase.html#ab0696abaaee0549a83385bed265f13b3">_height</a>; i++) {
<a name="l00835"></a>00835   <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[i] = <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[i - 1] + <a class="code" href="classVW_1_1ImageBase.html#a0fcb29cca75b2609c68c4d04c59fbe11">_width</a>;
<a name="l00836"></a>00836       }
<a name="l00837"></a>00837       <a class="code" href="classVW_1_1ImageBase.html#a67612e9794dd995503cdc71f282e62a2">_rowsalloced</a> = <span class="keyword">true</span>;
<a name="l00838"></a>00838     } <span class="keywordflow">else</span> {
<a name="l00839"></a>00839       <span class="comment">// No data</span>
<a name="l00840"></a>00840       <a class="code" href="classVW_1_1ImageBase.html#a67612e9794dd995503cdc71f282e62a2">_rowsalloced</a> = <span class="keyword">false</span>;
<a name="l00841"></a>00841     }
<a name="l00842"></a>00842   }
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00845"></a><a class="code" href="classVW_1_1ImageBase.html#ad09335787afbf6e63d3e20ee1d39a384">00845</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::SetPenColour</a>(<span class="keyword">const</span> PixelType&amp; colour)
<a name="l00846"></a>00846 {
<a name="l00847"></a>00847   <a class="code" href="classVW_1_1ImageBase.html#ab5f598c39b39418a477509ff589a633e">_pen_colour</a> = colour;
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt; <span class="keyword">inline</span> PixelType 
<a name="l00851"></a><a class="code" href="classVW_1_1ImageBase.html#a9b13a2a240266bd3f20dd8fd605c78b8">00851</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::GetPenColour</a>()<span class="keyword"> const</span>
<a name="l00852"></a>00852 <span class="keyword"></span>{
<a name="l00853"></a>00853   <span class="keywordflow">return</span> <a class="code" href="classVW_1_1ImageBase.html#ab5f598c39b39418a477509ff589a633e">_pen_colour</a>;
<a name="l00854"></a>00854 }
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 <span class="keyword">template</span> &lt;<span class="keyword">class</span> PixelType, <span class="keyword">class</span> PixelPtr&gt; <span class="keyword">inline</span> <span class="keywordtype">void</span> 
<a name="l00857"></a><a class="code" href="classVW_1_1ImageBase.html#abec0fcb5e6258a6d4afa789590841770">00857</a> <a class="code" href="classVW_1_1ImageBase.html" title="The base class from which all images are made.">VW::ImageBase&lt;PixelType,PixelPtr&gt;::DrawLine</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x0, <span class="keyword">const</span> <span class="keywordtype">double</span> y0,
<a name="l00858"></a>00858               <span class="keyword">const</span> <span class="keywordtype">double</span> x1, <span class="keyword">const</span> <span class="keywordtype">double</span> y1)
<a name="l00859"></a>00859 {
<a name="l00860"></a>00860   <span class="keyword">using namespace </span>std; <span class="comment">// sqrt is sometimes in (GCC), sometimes not (VC++)</span>
<a name="l00861"></a>00861   <span class="keyword">const</span> <span class="keywordtype">double</span> length = <a class="code" href="namespacestd.html#a02121a7f0ebacde9b6265492db7f8e97">sqrt</a>((x1-x0)*(x1-x0)+(y1-y0)*(y1-y0));
<a name="l00862"></a>00862   <span class="keyword">const</span> <span class="keywordtype">double</span> dx = (x1-x0)/length;
<a name="l00863"></a>00863   <span class="keyword">const</span> <span class="keywordtype">double</span> dy = (y1-y0)/length;
<a name="l00864"></a>00864   <span class="keywordtype">double</span> x = x0, y = y0;
<a name="l00865"></a>00865   <span class="keywordflow">for</span> (<span class="keywordtype">double</span> a=0.0;a&lt;=length;a++) {
<a name="l00866"></a>00866     <a class="code" href="classVW_1_1ImageBase.html#abd7b663fe35460461d09fedefcf2e21b" title="Pointers to the start of each row.">pixel</a>[int(y+0.5)][int(x+0.5)] = <a class="code" href="classVW_1_1ImageBase.html#ab5f598c39b39418a477509ff589a633e">_pen_colour</a>;
<a name="l00867"></a>00867     x += dx; y += dy;
<a name="l00868"></a>00868   }
<a name="l00869"></a>00869 }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 <span class="preprocessor">#endif        </span><span class="comment">/* _imagebase_h_ */</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on Sun Mar 21 09:55:46 2010 for VW by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
